<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ALF: hamiltonian Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">hamiltonian Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module defines the Hamiltonian and observables. Here, we have included a set of predefined Hamiltonians. They include the Hubbard and SU(N) tV models on honeycomb, pi-flux and square lattices.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:adb3e5219cf91a65242c9718ba6d9f45d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#adb3e5219cf91a65242c9718ba6d9f45d">ham_set</a></td></tr>
<tr class="memdesc:adb3e5219cf91a65242c9718ba6d9f45d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the Hamiltonian.  <a href="#adb3e5219cf91a65242c9718ba6d9f45d">More...</a><br /></td></tr>
<tr class="separator:adb3e5219cf91a65242c9718ba6d9f45d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadd308aa7d53991575550174f86753a8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aadd308aa7d53991575550174f86753a8">ham_v</a></td></tr>
<tr class="memdesc:aadd308aa7d53991575550174f86753a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the interaction.  <a href="#aadd308aa7d53991575550174f86753a8">More...</a><br /></td></tr>
<tr class="separator:aadd308aa7d53991575550174f86753a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6204b6ca97dda3a87a78d4cebbd7fb2f"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> (n, nt, Hs_new)</td></tr>
<tr class="memdesc:a6204b6ca97dda3a87a78d4cebbd7fb2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single spin flip S0 ratio.  <a href="#a6204b6ca97dda3a87a78d4cebbd7fb2f">More...</a><br /></td></tr>
<tr class="separator:a6204b6ca97dda3a87a78d4cebbd7fb2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77462baf56d2efa9c1d45ef9639ed390"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a77462baf56d2efa9c1d45ef9639ed390">setup_ising_action</a></td></tr>
<tr class="memdesc:a77462baf56d2efa9c1d45ef9639ed390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup bonds and median lattice.  <a href="#a77462baf56d2efa9c1d45ef9639ed390">More...</a><br /></td></tr>
<tr class="separator:a77462baf56d2efa9c1d45ef9639ed390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cbb043ba4fe7449d77c99d16d48ef6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aa8cbb043ba4fe7449d77c99d16d48ef6">alloc_obs</a> (Ltau)</td></tr>
<tr class="memdesc:aa8cbb043ba4fe7449d77c99d16d48ef6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifiy the equal time and time displaced observables.  <a href="#aa8cbb043ba4fe7449d77c99d16d48ef6">More...</a><br /></td></tr>
<tr class="separator:aa8cbb043ba4fe7449d77c99d16d48ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0648841005a77912a7f2d1afd0ae26fe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a0648841005a77912a7f2d1afd0ae26fe">global_move</a> (T0_Proposal_ratio, nsigma_old, size_clust)</td></tr>
<tr class="memdesc:a0648841005a77912a7f2d1afd0ae26fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global moves.  <a href="#a0648841005a77912a7f2d1afd0ae26fe">More...</a><br /></td></tr>
<tr class="separator:a0648841005a77912a7f2d1afd0ae26fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af627770a99fbe09e6cf52af735e251ba"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#af627770a99fbe09e6cf52af735e251ba">delta_s0_global</a> (Nsigma_old)</td></tr>
<tr class="memdesc:af627770a99fbe09e6cf52af735e251ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ratio exp(S0(new))/exp(S0(old))  <a href="#af627770a99fbe09e6cf52af735e251ba">More...</a><br /></td></tr>
<tr class="separator:af627770a99fbe09e6cf52af735e251ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7512891175f70d6103bfcfea844933d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a7512891175f70d6103bfcfea844933d6">obser</a> (GR, Phase, Ntau)</td></tr>
<tr class="memdesc:a7512891175f70d6103bfcfea844933d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes equal time observables.  <a href="#a7512891175f70d6103bfcfea844933d6">More...</a><br /></td></tr>
<tr class="separator:a7512891175f70d6103bfcfea844933d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fbb052f8da280932ee0a5332531f58"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a62fbb052f8da280932ee0a5332531f58">obsert</a> (NT, GT0, G0T, G00, GTT, PHASE)</td></tr>
<tr class="memdesc:a62fbb052f8da280932ee0a5332531f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes time displaced observables.  <a href="#a62fbb052f8da280932ee0a5332531f58">More...</a><br /></td></tr>
<tr class="separator:a62fbb052f8da280932ee0a5332531f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e41e35f2eb6cbc0ecb4333731a265a0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a6e41e35f2eb6cbc0ecb4333731a265a0">pr_obs</a> (LTAU)</td></tr>
<tr class="memdesc:a6e41e35f2eb6cbc0ecb4333731a265a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints out the bins. No need to change this routine.  <a href="#a6e41e35f2eb6cbc0ecb4333731a265a0">More...</a><br /></td></tr>
<tr class="separator:a6e41e35f2eb6cbc0ecb4333731a265a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66eff667baae554d8db1390d57e2e24"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#ad66eff667baae554d8db1390d57e2e24">init_obs</a> (Ltau)</td></tr>
<tr class="memdesc:ad66eff667baae554d8db1390d57e2e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes observables to zero before each bins. No need to change this routine.  <a href="#ad66eff667baae554d8db1390d57e2e24">More...</a><br /></td></tr>
<tr class="separator:ad66eff667baae554d8db1390d57e2e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2d55c98f1f54354cb2319aab73d03f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aac2d55c98f1f54354cb2319aab73d03f">global_move_tau</a> (T0_Proposal_ratio, S0_ratio, Flip_list, Flip_length, Flip_value, ntau)</td></tr>
<tr class="memdesc:aac2d55c98f1f54354cb2319aab73d03f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify a global move on a given time slice tau.  <a href="#aac2d55c98f1f54354cb2319aab73d03f">More...</a><br /></td></tr>
<tr class="separator:aac2d55c98f1f54354cb2319aab73d03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea2e345f43022b9c6bf72b2d297eaa1c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aea2e345f43022b9c6bf72b2d297eaa1c">hamiltonian_set_nsigma</a> (Initial_field)</td></tr>
<tr class="memdesc:aea2e345f43022b9c6bf72b2d297eaa1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The user can set the initial field.  <a href="#aea2e345f43022b9c6bf72b2d297eaa1c">More...</a><br /></td></tr>
<tr class="separator:aea2e345f43022b9c6bf72b2d297eaa1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a784fd999e79bf7eea97eb4b7695db65d"><td class="memItemLeft" align="right" valign="top">type(operator), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a></td></tr>
<tr class="separator:a784fd999e79bf7eea97eb4b7695db65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0774a95b11b5a1f086afd9e0ec141273"><td class="memItemLeft" align="right" valign="top">type(operator), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a0774a95b11b5a1f086afd9e0ec141273">op_t</a></td></tr>
<tr class="separator:a0774a95b11b5a1f086afd9e0ec141273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c2ccadb9ff957e46da6a1b7484755f1"><td class="memItemLeft" align="right" valign="top">type(wavefunction), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">wf_l</a></td></tr>
<tr class="separator:a3c2ccadb9ff957e46da6a1b7484755f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb663a56d63496d9b9f883e84d527ed"><td class="memItemLeft" align="right" valign="top">type(wavefunction), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">wf_r</a></td></tr>
<tr class="separator:adbb663a56d63496d9b9f883e84d527ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47e39398314b7c8194c8736008fc447c"><td class="memItemLeft" align="right" valign="top">class(fields), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a></td></tr>
<tr class="separator:a47e39398314b7c8194c8736008fc447c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13c80692ce5836cdc65570c6c56b0801"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></td></tr>
<tr class="separator:a13c80692ce5836cdc65570c6c56b0801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af508f251b4965d458d35546984d69fb2"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></td></tr>
<tr class="separator:af508f251b4965d458d35546984d69fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8b556cb31a51119226fa1b1afa87eb1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></td></tr>
<tr class="separator:ac8b556cb31a51119226fa1b1afa87eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643cec8e88998409a6f5ae27915b5e87"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></td></tr>
<tr class="separator:a643cec8e88998409a6f5ae27915b5e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e72b755eecc2d14135adc1cfdb25f53"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></td></tr>
<tr class="separator:a5e72b755eecc2d14135adc1cfdb25f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77179b40953aaf13f002b7f4fc0b7456"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a></td></tr>
<tr class="separator:a77179b40953aaf13f002b7f4fc0b7456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef693c8b68751ed1e8ffc50b12890e02"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a></td></tr>
<tr class="separator:aef693c8b68751ed1e8ffc50b12890e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38fa1c4cce2a1f8143d5a16fbddea3cf"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a></td></tr>
<tr class="separator:a38fa1c4cce2a1f8143d5a16fbddea3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad908b6d21bf99ba3ff9dae0fe4d1882d"><td class="memItemLeft" align="right" valign="top">type(lattice), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a></td></tr>
<tr class="separator:ad908b6d21bf99ba3ff9dae0fe4d1882d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c133d909ccb9361a5c4389a168db634"><td class="memItemLeft" align="right" valign="top">type(unit_cell), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a></td></tr>
<tr class="separator:a6c133d909ccb9361a5c4389a168db634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640dde0b8b9b036b73e855a3feaeb863"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">l1</a></td></tr>
<tr class="separator:a640dde0b8b9b036b73e855a3feaeb863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc044f61c660f6e51f750b378dd88ff4"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">l2</a></td></tr>
<tr class="separator:afc044f61c660f6e51f750b378dd88ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16532e80c0e204e028d3475cda56036e"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></td></tr>
<tr class="separator:a16532e80c0e204e028d3475cda56036e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb8c11095eba37577f0131f52c49b80"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></td></tr>
<tr class="separator:abeb8c11095eba37577f0131f52c49b80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9bca3236ec22ed3f6a789aa662e3b7"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></td></tr>
<tr class="separator:a5d9bca3236ec22ed3f6a789aa662e3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c917b398d6e8df7361089384c7287b"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a></td></tr>
<tr class="separator:a03c917b398d6e8df7361089384c7287b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e41bd505d50b7cfcdcdacf78cbe8cd4"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a></td></tr>
<tr class="separator:a5e41bd505d50b7cfcdcdacf78cbe8cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b8d5403685aa76c409005a817aa003"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">ham_xi</a></td></tr>
<tr class="separator:a04b8d5403685aa76c409005a817aa003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e147e50361e67d0692f6f6306be5a17"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a></td></tr>
<tr class="separator:a7e147e50361e67d0692f6f6306be5a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a884ce86017041b4ec130264300dfb201"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a></td></tr>
<tr class="separator:a884ce86017041b4ec130264300dfb201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0301588aa05699e0fcfb0d16d4c738"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a></td></tr>
<tr class="separator:a1e0301588aa05699e0fcfb0d16d4c738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff2d175685754a703b58a646b249ff1"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">ham_alpha</a></td></tr>
<tr class="separator:a1ff2d175685754a703b58a646b249ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1b1fa8c65688bd7fdbb7c2ce1c73be"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">percent_change</a></td></tr>
<tr class="separator:aac1b1fa8c65688bd7fdbb7c2ce1c73be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49efcdbb93b14e202caa847a20e12d3f"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a49efcdbb93b14e202caa847a20e12d3f">xb_y</a></td></tr>
<tr class="separator:a49efcdbb93b14e202caa847a20e12d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe26506e76f653d380605147a5dd0aa"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a2fe26506e76f653d380605147a5dd0aa">phi_y</a></td></tr>
<tr class="separator:a2fe26506e76f653d380605147a5dd0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66daa09f7b7596fa7677e04491f81a37"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a></td></tr>
<tr class="separator:a66daa09f7b7596fa7677e04491f81a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf05c9e78bee7d0e443c116d5d517750"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></td></tr>
<tr class="separator:aaf05c9e78bee7d0e443c116d5d517750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b59a5712728c871c3087c4a273e18c8"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></td></tr>
<tr class="separator:a2b59a5712728c871c3087c4a273e18c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb1ed1c4713279c8bd31e28fffa57b9"><td class="memItemLeft" align="right" valign="top">character(len=64), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a></td></tr>
<tr class="separator:adfb1ed1c4713279c8bd31e28fffa57b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a837082263f9f0c9dc33bbc733ec52605"><td class="memItemLeft" align="right" valign="top">character(len=64), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a></td></tr>
<tr class="separator:a837082263f9f0c9dc33bbc733ec52605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288379d3f41a573b4e2b2274425fbce2"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a288379d3f41a573b4e2b2274425fbce2">one_dimensional</a></td></tr>
<tr class="separator:a288379d3f41a573b4e2b2274425fbce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194deafd4e8cee2679b632e61ea9e895"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a></td></tr>
<tr class="separator:a194deafd4e8cee2679b632e61ea9e895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292641502e14286faa4fc4c5e2692ec4"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a></td></tr>
<tr class="separator:a292641502e14286faa4fc4c5e2692ec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636c1b29569310a368b3377ce1382d8a"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a></td></tr>
<tr class="separator:a636c1b29569310a368b3377ce1382d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0801e185b65b8a7f74d6963fd2b5e8bf"><td class="memItemLeft" align="right" valign="top">type(obser_vec), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a></td></tr>
<tr class="memdesc:a0801e185b65b8a7f74d6963fd2b5e8bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Privat Observables.  <a href="#a0801e185b65b8a7f74d6963fd2b5e8bf">More...</a><br /></td></tr>
<tr class="separator:a0801e185b65b8a7f74d6963fd2b5e8bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb09a967466f8b65fd016da2d380cb70"><td class="memItemLeft" align="right" valign="top">type(obser_latt), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a></td></tr>
<tr class="separator:aeb09a967466f8b65fd016da2d380cb70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed23e3d96cff5fd9c06aee2339c8e11"><td class="memItemLeft" align="right" valign="top">type(obser_latt), dimension(:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a></td></tr>
<tr class="separator:aaed23e3d96cff5fd9c06aee2339c8e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab5e538e523c3d4ddf90cda19ee2532"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), dimension(-1:1), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a></td></tr>
<tr class="memdesc:a6ab5e538e523c3d4ddf90cda19ee2532"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the Ising action.  <a href="#a6ab5e538e523c3d4ddf90cda19ee2532">More...</a><br /></td></tr>
<tr class="separator:a6ab5e538e523c3d4ddf90cda19ee2532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbad453b0abfe8529f92f6c505fdddbc"><td class="memItemLeft" align="right" valign="top">real(kind=kind(0.d0)), dimension(-1:1), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">dw_ising_space</a></td></tr>
<tr class="separator:abbad453b0abfe8529f92f6c505fdddbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d850ae847d6fe0593ee4b4c61423c6"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a></td></tr>
<tr class="separator:a67d850ae847d6fe0593ee4b4c61423c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84417401f46ecdbfd3ceae3d80578bd4"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a></td></tr>
<tr class="separator:a84417401f46ecdbfd3ceae3d80578bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a955eb1417641b40fe24365752fc63942"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a></td></tr>
<tr class="separator:a955eb1417641b40fe24365752fc63942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module defines the Hamiltonian and observables. Here, we have included a set of predefined Hamiltonians. They include the Hubbard and SU(N) tV models on honeycomb, pi-flux and square lattices. </p>
<dl class="section author"><dt>Author</dt><dd>ALF-project</dd></dl>
<p>The public variables of this module are the following</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[public]</td><td>OP_V <pre class="fragment"> Type (Operator), dimension(:,:), allocatable 
 List of operators of type=1,2 and 3 describing the sequence of interactions on a time slice.
 The first index runs over this sequence. The second corresponds to the flavor index.  </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>OP_T <pre class="fragment"> Type (Operator), dimension(:,:), allocatable  
 Sequence of  operators  accounting for the  hopping on a  time slice. This can include  various
 checkerboard decompositions. The first index runs over this sequence. The second corresponds to
 the flavor index. </pre><ul>
<li>The progagation reads: <img class="formulaInl" alt="$ \prod_{\tau} \; \; \prod_{n=1}^{N_V}e^{V_n(\tau)} \prod_{n=1}^{N_T}e^{T_n} $" src="form_5.png"/>. That is first the hopping and then the potential energy.</li>
</ul>
</td></tr>
    <tr><td class="paramname">[public]</td><td>WF_L <pre class="fragment">Type (WaveFunction), dimension(:),   allocatable
 Left trial wave function.  </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>WF_R <pre class="fragment">Type (WaveFunction), dimension(:),   allocatable
 Right trial wave function.   For both wave functions the index runs over the flavor index. </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>nsigma(:,:) <pre class="fragment">Class(Fields), allocatable
 Array containing all auxiliary fields. The first index runs through the operator sequence. The second
 through the time slies.   </pre> </td></tr>
    <tr><td class="paramname">[public]</td><td>Ndim <pre class="fragment">Integer
 Total number of orbitals. e.g. # unit cells * # orbitals per unit cell.  </pre> </td></tr>
    <tr><td class="paramname">[public]</td><td>N_FL <pre class="fragment">Integer
 # of flavors.  Propagation is block diagonal in flavors.  </pre> </td></tr>
    <tr><td class="paramname">[public]</td><td>N_SUN <pre class="fragment">Integer
 # of colors.  Propagation is color independent.  </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>Ltrot <pre class="fragment">Integer
 Available measurment interval in units of Delta Tau. </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>Thtrot <pre class="fragment">Integer
 Effective projection parameter in units of Delta Tau.  (Only relevant if projective option is turned on) </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>Projector <pre class="fragment">Logical
 Flag for projector. If true then the total number of time slices will correspond to Ltrot + 2*Thtrot </pre></td></tr>
    <tr><td class="paramname">[public]</td><td>Group_Comm <pre class="fragment">Integer
 Defines MPI communicator  </pre> </td></tr>
    <tr><td class="paramname">[public]</td><td>Symm <pre class="fragment">Logical  </pre> If set to true then the green functions will be symmetrized before being sent to the Obser, ObserT subroutines. In particular, the transformation, <img class="formulaInl" alt="$ \tilde{G} = e^{-\Delta \tau T /2 } G e^{\Delta \tau T /2 } $" src="form_6.png"/> will be carried out and <img class="formulaInl" alt="$ \tilde{G} $" src="form_7.png"/> will be sent to the Obser and ObserT subroutines. Note that if you want to use this feature, then you have to be sure the hopping and interaction terms are decomposed symmetrically. If Symm is true, the propagation reads: <img class="formulaInl" alt="$ \prod_{\tau} \; \; \prod_{n=N_T}^{1}e^{T_n/2} \prod_{n=1}^{N_V}e^{V_n(\tau)} \prod_{n=1}^{N_T}e^{T_n/2} $" src="form_8.png"/></td></tr>
  </table>
  </dd>
</dl>
<p>You still have to add some docu for the other private variables in this module. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa8cbb043ba4fe7449d77c99d16d48ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8cbb043ba4fe7449d77c99d16d48ef6">&#9670;&nbsp;</a></span>alloc_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::alloc_obs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ltau</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specifiy the equal time and time displaced observables. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ltau</td><td>Ltau=1 if time displaced correlations are considered. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">876</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">latt_unit</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00144">ltrot</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00165">obs_eq</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00164">obs_scal</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00166">obs_tau</a>, <a class="el" href="observables__mod_8f90_source.html#l00075">observables::obser_latt_make()</a>, <a class="el" href="observables__mod_8f90_source.html#l00097">observables::obser_vec_make()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00145">thtrot</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(In)</span> :: Ltau</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;          <span class="keywordtype">Integer</span>    ::  i, N, Ns,Nt,No, Norb</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          <span class="keywordtype">Character (len=64)</span> ::  Filename</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          norb = <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%Norb</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <span class="comment">! Scalar observables</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <span class="keyword">Allocate</span> ( <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(4) )</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>,1)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;             <span class="keywordflow">select case</span> (i)</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;             <span class="keywordflow">case</span> (1)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                n = 1;   filename =<span class="stringliteral">&quot;Kin&quot;</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;             <span class="keywordflow">case</span> (2)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                n = 1;   filename =<span class="stringliteral">&quot;Pot&quot;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;             <span class="keywordflow">case</span> (3)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                n = 1;   filename =<span class="stringliteral">&quot;Part&quot;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;             <span class="keywordflow">case</span> (4)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                n = 1;   filename =<span class="stringliteral">&quot;Ener&quot;</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keywordflow">             case default</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keyword">Write</span>(6,*) <span class="stringliteral">&#39; Error in Alloc_obs &#39;</span>  </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">             end select</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;             <span class="keyword">Call </span>obser_vec_make(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i),n,filename)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="comment">! Equal time correlators</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <span class="keyword">Allocate</span> ( <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(5) )</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>,1)</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             <span class="keywordflow">select case</span> (i)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;             <span class="keywordflow">case</span> (1)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N;  no = norb;  filename =<span class="stringliteral">&quot;Green&quot;</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;             <span class="keywordflow">case</span> (2)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N;  no = norb;  filename =<span class="stringliteral">&quot;SpinZ&quot;</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;             <span class="keywordflow">case</span> (3)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N;  no = norb;  filename =<span class="stringliteral">&quot;SpinXY&quot;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;             <span class="keywordflow">case</span> (4)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N;  no = norb;  filename =<span class="stringliteral">&quot;Den&quot;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;             <span class="keywordflow">case</span> (5)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N;  no = norb;  filename =<span class="stringliteral">&quot;SpinT&quot;</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keywordflow">             case default</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="keyword">Write</span>(6,*) <span class="stringliteral">&#39; Error in Alloc_obs &#39;</span>  </div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordflow">             end select</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;             nt = 1</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;             <span class="keyword">Call </span>obser_latt_make(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i),ns,nt,no,filename)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          <span class="keywordflow">If</span> (ltau == 1) <span class="keywordflow">then</span> </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;             <span class="comment">! Equal time correlators</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;             <span class="keyword">Allocate</span> ( <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4) )</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;             <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>,1)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keywordflow">select case</span> (i)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">case</span> (1)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                   ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N; no = norb;  filename =<span class="stringliteral">&quot;Green&quot;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keywordflow">case</span> (2)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                   ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N; no = norb;  filename =<span class="stringliteral">&quot;SpinZ&quot;</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keywordflow">case</span> (3)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                   ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N; no = norb;  filename =<span class="stringliteral">&quot;SpinXY&quot;</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <span class="keywordflow">case</span> (4)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                   ns = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N; no = norb;  filename =<span class="stringliteral">&quot;Den&quot;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">                case default</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                   <span class="keyword">Write</span>(6,*) <span class="stringliteral">&#39; Error in Alloc_obs &#39;</span>  </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keywordflow">                end select</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                nt = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+1-2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <span class="keyword">Call </span>obser_latt_make(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i),ns,nt,no,filename)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keywordflow">          endif</span></div><div class="ttc" id="namespacehamiltonian_html_aaed23e3d96cff5fd9c06aee2339c8e11"><div class="ttname"><a href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">hamiltonian::obs_tau</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_tau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00166">Hamiltonian_Examples.f90:166</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a643cec8e88998409a6f5ae27915b5e87"><div class="ttname"><a href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">hamiltonian::ltrot</a></div><div class="ttdeci">integer ltrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00144">Hamiltonian_Examples.f90:144</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5e72b755eecc2d14135adc1cfdb25f53"><div class="ttname"><a href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">hamiltonian::thtrot</a></div><div class="ttdeci">integer thtrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00145">Hamiltonian_Examples.f90:145</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aeb09a967466f8b65fd016da2d380cb70"><div class="ttname"><a href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">hamiltonian::obs_eq</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_eq</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00165">Hamiltonian_Examples.f90:165</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a0801e185b65b8a7f74d6963fd2b5e8bf"><div class="ttname"><a href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">hamiltonian::obs_scal</a></div><div class="ttdeci">type(obser_vec), dimension(:), allocatable, private obs_scal</div><div class="ttdoc">Privat Observables. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00164">Hamiltonian_Examples.f90:164</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af627770a99fbe09e6cf52af735e251ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af627770a99fbe09e6cf52af735e251ba">&#9670;&nbsp;</a></span>delta_s0_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)) function hamiltonian::delta_s0_global </td>
          <td>(</td>
          <td class="paramtype">class (fields), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>Nsigma_old</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the ratio exp(S0(new))/exp(S0(old)) </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<p>This function computes the ratio</p><pre class="fragment">e^{-S0(nsigma)}/e^{-S0(nsigma_old)} </pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[IN]</td><td>nsigma_old, Type(Fields) <pre class="fragment">  Old configuration. The new configuration is stored in nsigma.</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">1008</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_h</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_j</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">l_bond</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00144">ltrot</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00140">nsigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, and <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>.</p>
<div class="fragment"><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <span class="comment">!  This function computes the ratio:  e^{-S0(nsigma)}/e^{-S0(nsigma_old)}</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          <span class="keywordtype">Implicit none</span> </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          <span class="comment">! Arguments</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          class(<a class="code" href="structfields__mod_1_1fields.html">fields</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">INTENT(IN)</span> :: nsigma_old</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <span class="comment">! Local</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="keywordtype">Integer</span> :: I,n,n1,n2,n3,n4,nt,nt1, nc_F, nc_J, nc_h_p, nc_h_m</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;         </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <a class="code" href="namespacehamiltonian.html#af627770a99fbe09e6cf52af735e251ba">delta_s0_global</a> = 1.d0</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span> ) <span class="keywordflow">then</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;             nc_f = 0</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;             nc_j = 0</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;             nc_h_p = 0</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;             nc_h_m = 0</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                n1  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(i,1)</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                n2  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,1,0),2)</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                n3  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,0,1),1)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                n4  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(i,2)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="keywordflow">do</span> nt = 1,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                   nt1 = nt +1 </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                   <span class="keywordflow">if</span> (nt == <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>) nt1 = 1</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                   <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n1,nt) == <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n1,nt1) ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                      nc_h_p = nc_h_p + 1</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                      nc_h_m = nc_h_m + 1</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                   <span class="keywordflow">if</span> (nsigma_old%i(n1,nt) == nsigma_old%i(n1,nt1) ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                      nc_h_p = nc_h_p - 1</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                      nc_h_m = nc_h_m - 1</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                   <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n4,nt) == <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n4,nt1) ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                      nc_h_p = nc_h_p + 1</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                      nc_h_m = nc_h_m + 1</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                   <span class="keywordflow">if</span> (nsigma_old%i(n4,nt) == nsigma_old%i(n4,nt1) ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                      nc_h_p = nc_h_p - 1</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                      nc_h_m = nc_h_m - 1</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                   </div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                   nc_f = nc_f + <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i    (n1,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i    (n2,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i    (n3,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i  (n4,nt)  &amp;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        &amp;      - nsigma_old%i(n1,nt)*nsigma_old%i(n2,nt)*nsigma_old%i(n3,nt)*nsigma_old%i(n4,nt) </div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                   </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                   nc_j = nc_j + <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n1,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n2,nt) + &amp;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        &amp;        <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n2,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n3,nt) + &amp;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        &amp;        <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n3,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n4,nt) + &amp;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        &amp;        <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n4,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n1,nt) - &amp;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        &amp;        nsigma_old%i(n1,nt)*nsigma_old%i(n2,nt) - &amp;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        &amp;        nsigma_old%i(n2,nt)*nsigma_old%i(n3,nt) - &amp;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        &amp;        nsigma_old%i(n3,nt)*nsigma_old%i(n4,nt) - &amp;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                        &amp;        nsigma_old%i(n4,nt)*nsigma_old%i(n1,nt) </div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                   </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;             <span class="comment">!             Delta_S0_global = ( sinh(Dtau*Ham_h)**nc_h_m ) * (cosh(Dtau*Ham_h)**nc_h_p) * &amp;</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;             <span class="comment">!                  &amp;            exp( -Dtau*(Ham_F*real(nc_F,kind(0.d0)) -  Ham_J*real(nc_J,kind(0.d0))))</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;             <span class="comment">! No flux in example code. May want to include it.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;             <a class="code" href="namespacehamiltonian.html#af627770a99fbe09e6cf52af735e251ba">delta_s0_global</a> = ( sinh(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a>)**nc_h_m ) * (cosh(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a>)**nc_h_p) * &amp;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                  &amp;            exp( <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>* <a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a>*<span class="keywordtype">real</span>(nc_J,kind(0.d0)))</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;             <span class="comment">!Write(6,*) Delta_S0_global</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="structfields__mod_1_1fields_html"><div class="ttname"><a href="structfields__mod_1_1fields.html">fields_mod::fields</a></div><div class="ttdef"><b>Definition:</b> <a href="Fields__mod_8f90_source.html#l00066">Fields_mod.f90:66</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a03c917b398d6e8df7361089384c7287b"><div class="ttname"><a href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">hamiltonian::ham_h</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_h</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a643cec8e88998409a6f5ae27915b5e87"><div class="ttname"><a href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">hamiltonian::ltrot</a></div><div class="ttdeci">integer ltrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00144">Hamiltonian_Examples.f90:144</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a67d850ae847d6fe0593ee4b4c61423c6"><div class="ttname"><a href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">hamiltonian::l_bond</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private l_bond</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5e41bd505d50b7cfcdcdacf78cbe8cd4"><div class="ttname"><a href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">hamiltonian::ham_j</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_j</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a47e39398314b7c8194c8736008fc447c"><div class="ttname"><a href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">hamiltonian::nsigma</a></div><div class="ttdeci">class(fields), allocatable nsigma</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00140">Hamiltonian_Examples.f90:140</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_af627770a99fbe09e6cf52af735e251ba"><div class="ttname"><a href="namespacehamiltonian.html#af627770a99fbe09e6cf52af735e251ba">hamiltonian::delta_s0_global</a></div><div class="ttdeci">real(kind=kind(0.d0)) function delta_s0_global(Nsigma_old)</div><div class="ttdoc">Computes the ratio exp(S0(new))/exp(S0(old)) </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l01008">Hamiltonian_Examples.f90:1008</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0648841005a77912a7f2d1afd0ae26fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0648841005a77912a7f2d1afd0ae26fe">&#9670;&nbsp;</a></span>global_move()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::global_move </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind(0.d0)), intent(out)&#160;</td>
          <td class="paramname"><em>T0_Proposal_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class (fields), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>nsigma_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind(0.d0)), intent(out)&#160;</td>
          <td class="paramname"><em>size_clust</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global moves. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<p>This routine generates a global update and returns the propability T0_Proposal_ratio = T0( sigma_out-&gt; sigma_in ) / T0( sigma_in -&gt; sigma_out) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[IN]</td><td>nsigma_old, Type(Fields) <pre class="fragment">  Old configuration. The new configuration is stored in nsigma.</pre> </td></tr>
    <tr><td class="paramname">[OUT]</td><td>T0_Proposal_ratio Real  T0_Proposal_ratio = T0( sigma_new -&gt; sigma_old ) / T0( sigma_old -&gt; sigma_new) <br />
  </td></tr>
    <tr><td class="paramname">[OUT]</td><td>Size_clust Real <pre class="fragment">  Size of cluster that will be flipped.</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00971">971</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="nranf_8f90_source.html#l00002">nranf()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00140">nsigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>.</p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          <span class="keywordtype">Real (Kind=Kind(0.d0))</span>, <span class="keywordtype">intent(out)</span> :: T0_Proposal_ratio, size_clust</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          class(<a class="code" href="structfields__mod_1_1fields.html">fields</a>),  <span class="keywordtype">allocatable</span>, <span class="keywordtype">Intent(IN)</span>  :: nsigma_old</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          <span class="comment">! Local</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;          <span class="keywordtype">Integer</span> :: N_op, N_tau, n1,n2, n</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;          t0_proposal_ratio  = 1.d0</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          size_clust         = 3.d0</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%f = nsigma_old%f</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%t = nsigma_old%t</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          n_op  = <span class="keyword">size</span>(nsigma_old%f,1)</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          n_tau = <span class="keyword">size</span>(nsigma_old%f,2)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="keywordflow">Do</span> n  = 1, nint(size_clust)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;             n1 = <a class="code" href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a>(n_op)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;             n2 = <a class="code" href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a>(n_tau)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;             <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%f(n1,n2) = nsigma_old%flip(n1,n2)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;          </div><div class="ttc" id="structfields__mod_1_1fields_html"><div class="ttname"><a href="structfields__mod_1_1fields.html">fields_mod::fields</a></div><div class="ttdef"><b>Definition:</b> <a href="Fields__mod_8f90_source.html#l00066">Fields_mod.f90:66</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a47e39398314b7c8194c8736008fc447c"><div class="ttname"><a href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">hamiltonian::nsigma</a></div><div class="ttdeci">class(fields), allocatable nsigma</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00140">Hamiltonian_Examples.f90:140</a></div></div>
<div class="ttc" id="nranf_8f90_html_a5eabf5c182ccccfd8bb7fe2cce6e7f45"><div class="ttname"><a href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a></div><div class="ttdeci">integer function nranf(N)</div><div class="ttdef"><b>Definition:</b> <a href="nranf_8f90_source.html#l00002">nranf.f90:2</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac2d55c98f1f54354cb2319aab73d03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac2d55c98f1f54354cb2319aab73d03f">&#9670;&nbsp;</a></span>global_move_tau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::global_move_tau </td>
          <td>(</td>
          <td class="paramtype">real (kind = kind(0.d0)), intent(out)&#160;</td>
          <td class="paramname"><em>T0_Proposal_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = kind(0.d0)), intent(out)&#160;</td>
          <td class="paramname"><em>S0_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>Flip_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>Flip_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = kind(0.d0)), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>Flip_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specify a global move on a given time slice tau. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ntau</td><td>Integer <pre class="fragment">  Time slice</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">T0_Proposal_ratio,Real</td><td><pre class="fragment">  T0_Proposal_ratio = T0( sigma_new -&gt; sigma ) /  T0( sigma -&gt; sigma_new)</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">S0_ratio,Real</td><td><pre class="fragment">  S0_ratio = e^( S_0(sigma_new) ) / e^( S_0(sigma) )</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Flip_length</td><td>Integer <pre class="fragment">  Number of flips stored in the first  Flip_length entries of the array Flip_values.
  Has to be smaller than NDIM</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Flip_list</td><td>Integer(Ndim) <pre class="fragment">  List of spins to be flipped: nsigma%f(Flip_list(1),ntau) ... nsigma%f(Flip_list(Flip_Length),ntau)
  Note that Ndim = size(Op_V,1)</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Flip_value</td><td>Real(Ndim) <pre class="fragment">  Flip_value(:)= nsigma%flip(Flip_list(:),ntau)
  Note that Ndim = size(Op_V,1)</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">1474</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="LRC__mod_8f90_source.html#l00418">lrc_mod::lrc_draw_field()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00141">ndim</a>, <a class="el" href="nranf_8f90_source.html#l00002">nranf()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00140">nsigma</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00136">op_v</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00155">percent_change</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Wrapgr__mod_8f90_source.html#l00351">wrapgr_mod::wrapgr_random_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          </div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="keywordtype">Implicit none</span> </div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          <span class="keywordtype">Real (Kind = Kind(0.d0))</span>,<span class="keywordtype">INTENT(OUT)</span> :: T0_Proposal_ratio,  S0_ratio</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          <span class="keywordtype">Integer</span>                , <span class="keywordtype">INTENT(OUT)</span> :: Flip_list(:)</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;          <span class="keywordtype">Real (Kind = Kind(0.d0))</span>,<span class="keywordtype">INTENT(OUT)</span> :: Flip_value(:)</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">INTENT(OUT)</span> :: Flip_length</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">INTENT(IN)</span>    :: ntau</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="comment">! Local</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="keywordtype">Integer</span> :: n_op, n, ns</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <span class="keywordtype">Real (Kind=Kind(0.d0))</span> :: T0_proposal</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          <span class="keywordflow">If</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;LRC&quot;</span> ) <span class="keywordflow">then</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;             <span class="keyword">Call </span>lrc_draw_field(<a class="code" href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">percent_change</a>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%f(:,ntau), flip_value,<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;             <span class="keywordflow">Do</span> n = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                flip_list(n) = n</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                <span class="comment">!Write(6,*) Flip_value(n), nsigma%f(n,ntau)</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;             <span class="comment">!Write(6,*)</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;             flip_length    = <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;             <span class="comment">! T0_Proposal_ration exactly cancels S0_ratio</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;             t0_proposal_ratio = 1.d0</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;             s0_ratio          = 1.d0</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;             flip_length = <a class="code" href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a>(4)</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;             <span class="keywordflow">do</span> n = 1,flip_length </div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                n_op = <a class="code" href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a>(<span class="keyword">size</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>,1))</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                flip_list(n)  = n_op</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                flip_value(n) = <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%flip(n_op,ntau)</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(n_op,1)%type == 1 ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                   s0_ratio          =   <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a>(n_op,ntau,flip_value(n))</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                   t0_proposal       =  1.d0 - 1.d0/(1.d0+s0_ratio) <span class="comment">! No move prob</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                   <span class="keywordflow">If</span> ( t0_proposal &gt; ranf_wrap() ) <span class="keywordflow">then</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                      t0_proposal_ratio =  1.d0 / s0_ratio</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                      t0_proposal_ratio = 0.d0</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                   t0_proposal_ratio = 1.d0</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                   s0_ratio          = 1.d0</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          </div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a47e39398314b7c8194c8736008fc447c"><div class="ttname"><a href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">hamiltonian::nsigma</a></div><div class="ttdeci">class(fields), allocatable nsigma</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00140">Hamiltonian_Examples.f90:140</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a13c80692ce5836cdc65570c6c56b0801"><div class="ttname"><a href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">hamiltonian::ndim</a></div><div class="ttdeci">integer ndim</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00141">Hamiltonian_Examples.f90:141</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a784fd999e79bf7eea97eb4b7695db65d"><div class="ttname"><a href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">hamiltonian::op_v</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_v</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00136">Hamiltonian_Examples.f90:136</a></div></div>
<div class="ttc" id="nranf_8f90_html_a5eabf5c182ccccfd8bb7fe2cce6e7f45"><div class="ttname"><a href="nranf_8f90.html#a5eabf5c182ccccfd8bb7fe2cce6e7f45">nranf</a></div><div class="ttdeci">integer function nranf(N)</div><div class="ttdef"><b>Definition:</b> <a href="nranf_8f90_source.html#l00002">nranf.f90:2</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6204b6ca97dda3a87a78d4cebbd7fb2f"><div class="ttname"><a href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">hamiltonian::s0</a></div><div class="ttdeci">real(kind=kind(0.d0)) function s0(n, nt, Hs_new)</div><div class="ttdoc">Single spin flip S0 ratio. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00755">Hamiltonian_Examples.f90:755</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aac1b1fa8c65688bd7fdbb7c2ce1c73be"><div class="ttname"><a href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">hamiltonian::percent_change</a></div><div class="ttdeci">real(kind=kind(0.d0)), private percent_change</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00155">Hamiltonian_Examples.f90:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb3e5219cf91a65242c9718ba6d9f45d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb3e5219cf91a65242c9718ba6d9f45d">&#9670;&nbsp;</a></span>ham_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::ham_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the Hamiltonian. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration </dd></dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">183</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">beta</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00159">checkerboard</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00147">group_comm</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00155">ham_alpha</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_chem</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_h</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_j</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_t</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_tv</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_u</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_xi</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">invlist</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">l1</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">l2</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">latt_unit</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">lattice_type</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">list</a>, <a class="el" href="LRC__mod_8f90_source.html#l00142">lrc_mod::lrc_print()</a>, <a class="el" href="LRC__mod_8f90_source.html#l00217">lrc_mod::lrc_set_vij()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00144">ltrot</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00142">n_fl</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00141">ndim</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00137">op_t</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00155">percent_change</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">phi_x</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00156">phi_y</a>, <a class="el" href="Predefined__structures_8f90_source.html#l00285">predefined_structures::predefined_hopping()</a>, <a class="el" href="Predefined__structures_8f90_source.html#l00096">predefined_structures::predefined_latt()</a>, <a class="el" href="Predefined__structures_8f90_source.html#l00722">predefined_structures::predefined_trialwavefunction()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00146">projector</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00148">symm</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">theta</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00145">thtrot</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00138">wf_l</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00139">wf_r</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">xb_x</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00156">xb_y</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#if defined (MPI) || defined(TEMPERING)</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor"></span>          <span class="keywordtype">Use </span>mpi</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor"></span>          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="keywordtype">integer</span>                :: ierr, N_part, nf</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <span class="keywordtype">Character (len=64)</span> :: file_info, file_para</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="comment">! L1, L2, Lattice_type, List(:,:), Invlist(:,:) --&gt;  Lattice information</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="comment">! Ham_T, Chem, Phi_X, XB_B, Checkerboard, Symm   --&gt;  Hopping</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="comment">! Interaction                              --&gt;  Model</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="comment">! Simulation type                          --&gt;  Finite  T or Projection  Symmetrize Trotter. </span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          namelist /var_lattice/  <a class="code" href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">l1</a>, <a class="code" href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">l2</a>, <a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>, <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a>,  <a class="code" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>, <a class="code" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a>, <a class="code" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a>, <a class="code" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          namelist /var_hubbard/  <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>,  <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>, <a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          namelist /var_lrc/      <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>, <a class="code" href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">ham_alpha</a>, <a class="code" href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">percent_change</a>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>, <a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          namelist /var_ising/    <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>, <a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a>, <a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a>, <a class="code" href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">ham_xi</a>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>, <a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          namelist /var_t_v/      <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>, <a class="code" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>, <a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor"></span>          <span class="keywordtype">Integer</span>        :: Isize, Irank, irank_g, isize_g, igroup</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordtype">Integer</span>        :: STATUS(MPI_STATUS_SIZE)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor"></span>          <span class="comment">! Global &quot;Default&quot; values.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>        = 1</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <a class="code" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a> = .false.</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <a class="code" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a>         = .false.</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          <a class="code" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a>        = 0.d0</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <a class="code" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a>         = 1.d0</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <a class="code" href="namespacehamiltonian.html#a2fe26506e76f653d380605147a5dd0aa">phi_y</a>        = 0.d0</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <a class="code" href="namespacehamiltonian.html#a49efcdbb93b14e202caa847a20e12d3f">xb_y</a>         = 1.d0</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>mpi_comm_size(mpi_comm_world,isize,ierr)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keyword">CALL </span>mpi_comm_rank(mpi_comm_world,irank,ierr)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keyword">call </span>mpi_comm_rank(<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>, irank_g, ierr)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          <span class="keyword">call </span>mpi_comm_size(<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>, isize_g, ierr)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          igroup           = irank/isize_g</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <span class="comment">!if ( irank_g == 0 )   write(6,*) &quot;Mpi Test&quot;, igroup, isize_g</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor"></span>          <span class="comment">! Open files</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#if defined(MPI) </span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor"></span>             file_para = <span class="stringliteral">&quot;parameters&quot;</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;             file_info = <span class="stringliteral">&quot;info&quot;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#if defined(TEMPERING) </span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"></span>             <span class="keyword">write</span>(file_para,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&quot;Temp_&quot;</span>,igroup,<span class="stringliteral">&quot;/parameters&quot;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;             <span class="keyword">write</span>(file_info,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&quot;Temp_&quot;</span>,igroup,<span class="stringliteral">&quot;/info&quot;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;             <span class="keyword">OPEN</span>(unit=5,file=file_para,status=<span class="stringliteral">&#39;old&#39;</span>,action=<span class="stringliteral">&#39;read&#39;</span>,iostat=ierr)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;             <span class="keyword">OPEN</span>(unit = 50,file=file_info,status=<span class="stringliteral">&quot;unknown&quot;</span>,position=<span class="stringliteral">&quot;append&quot;</span>)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          Endif</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">IF</span> (ierr /= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;unable to open &lt;parameters&gt;&#39;</span>,ierr</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                stop</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">             END IF</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;             <span class="keyword">READ</span>(5,nml=var_lattice)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          Endif</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">l1</a>          ,1  ,mpi_integer,   0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">l2</a>          ,1  ,mpi_integer,   0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>       ,1  ,mpi_integer,   0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a>       ,1  ,mpi_real8  ,   0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a>        ,1  ,mpi_real8  ,   0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a>       ,64 ,mpi_character, 0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a>,1  ,mpi_logical  , 0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a>        ,1  ,mpi_logical  , 0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>,64 ,mpi_character, 0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor"></span>          </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <span class="keyword">Call </span>predefined_latt(<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>, <a class="code" href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">l1</a>,<a class="code" href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">l2</a>,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>, <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>,<a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>,<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">If</span> (irank_g == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor"></span>             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;=====================================&#39;</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Model is      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Lattice is    : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;# of orbitals : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;             <span class="keywordflow">If</span> (<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a> == <span class="stringliteral">&quot;Square&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a> == <span class="stringliteral">&quot;One_dimensional&quot;</span> ) <span class="keywordflow">then</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;X_boundary    : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Flux_X        : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">             Endif</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Checkerboard  : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;             <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Symm. decomp  : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          Endif</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="comment">! Default is finite temperature. </span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          <a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a> = .false.</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a> = 0.d0</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = 0</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <span class="keywordflow">Select Case</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a>)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;LRC&quot;</span>)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;             <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a> = 2</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;             <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>  = 1</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor"></span>                <span class="keyword">READ</span>(5,nml=var_lrc)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = nint(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = nint(<a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Projective version&#39;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Theta         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Tau_max       : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Finite temperture version&#39;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Beta          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;dtau,Ltrot_eff: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_SUN         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_FL          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;t             : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_U         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_alpha     : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">ham_alpha</a></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Percent_change: &#39;</span>, <a class="code" href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">percent_change</a></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_chem      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span>   </div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor"></span>             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>         ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a>        ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>     ,1,mpi_logical,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>         ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>      ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>         ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">ham_alpha</a>     ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">percent_change</a>,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>          ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>          ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor"></span>             </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_Mz&quot;</span>)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;             <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>  = 2</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;             <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a> = 1</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor"></span>                <span class="keyword">READ</span>(5,nml=var_hubbard)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = nint(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = nint(<a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Projective version&#39;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Theta         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Tau_max       : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Finite temperture version&#39;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Beta          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;dtau,Ltrot_eff: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_SUN         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_FL          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;t             : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_U         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_chem      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span>             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>    ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a>   ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>,1,mpi_logical,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>    ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a> ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>    ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>     ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>     ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_SU2&quot;</span>)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;             <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a> = 1</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;             <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a> = 2</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor"></span>                <span class="keyword">READ</span>(5,nml=var_hubbard)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = nint(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = nint(<a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Projective version&#39;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Theta         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Tau_max       : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Finite temperture version&#39;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Beta          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;dtau,Ltrot_eff: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_SUN         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_FL          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;t             : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_U         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_chem      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor"></span>             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>    ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a>   ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>,1,mpi_logical,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>    ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a> ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>    ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>     ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>     ,1,mpi_real8  ,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span>)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;             <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a> = 1</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;             <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a> = 2</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor"></span>                <span class="keyword">READ</span>(5,nml=var_ising)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = nint(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = nint(<a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Projective version&#39;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Theta         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Tau_max       : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Finite temperture version&#39;</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Beta          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;dtau,Ltrot_eff: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_SUN         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_FL          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;t             : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_U         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_chem      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_xi        : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">ham_xi</a></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_J         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_h         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a> == <span class="stringliteral">&quot;Honeycomb&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a> == <span class="stringliteral">&quot;Pi_Flux&quot;</span> ) <span class="keywordflow">then</span> </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keyword">Write</span>(6,*) <span class="stringliteral">&quot;Hubbard_SU2_Ising is only implemented for a square lattice&quot;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                stop</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">             Endif</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor"></span>             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>    ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a>   ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>,1,mpi_logical,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>    ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a> ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>    ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>     ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>     ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">ham_xi</a>   ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a>    ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a>    ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor"></span>             <span class="keyword">Call </span><a class="code" href="namespacehamiltonian.html#a77462baf56d2efa9c1d45ef9639ed390">setup_ising_action</a></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;t_V&quot;</span>)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;             <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>  = 1</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor"></span>                <span class="keyword">READ</span>(5,nml=var_t_v )</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = nint(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a> = nint(<a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a>/<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a> = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>+2*<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Projective version&#39;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Theta         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">theta</a></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Tau_max       : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Finite temperture version&#39;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                  <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Beta          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;dtau,Ltrot_eff: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_SUN         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;N_FL          : &#39;</span>, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;t             : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_chem      : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Ham_tV         : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor"></span>             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>    ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">thtrot</a>   ,1,mpi_integer,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>,1,mpi_logical,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>    ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a> ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a>   ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>     ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;             <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">beta</a>     ,1,mpi_real8,0,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>,ierr)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          Case default</span> </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;             <span class="keyword">Write</span>(6,*) <span class="stringliteral">&quot;Model not yet implemented!&quot;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;             stop</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordflow">          end Select</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          <span class="keyword">Call </span>predefined_hopping(<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>, <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>, <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>,<a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>, <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>, &amp;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;           &amp;                      <a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, <a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>, <a class="code" href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">ham_chem</a>, <a class="code" href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">xb_x</a>, <a class="code" href="namespacehamiltonian.html#a49efcdbb93b14e202caa847a20e12d3f">xb_y</a>, <a class="code" href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">phi_x</a>, <a class="code" href="namespacehamiltonian.html#a2fe26506e76f653d380605147a5dd0aa">phi_y</a>, &amp;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;           &amp;                      <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>,  <a class="code" href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">checkerboard</a>, <a class="code" href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">symm</a>, <a class="code" href="namespacehamiltonian.html#a0774a95b11b5a1f086afd9e0ec141273">op_t</a> )</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;          </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">projector</a>) <span class="keywordflow">then</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;             n_part = <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>/2</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;             <span class="keyword">Call </span>predefined_trialwavefunction(<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a> ,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,  <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>,<a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>, &amp;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                  &amp;                            n_part, <a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>,  <a class="code" href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">wf_l</a>, <a class="code" href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">wf_r</a>)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Degen of right trial wave function: &#39;</span>, <a class="code" href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">wf_r</a>(nf)%Degen</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                   <span class="keyword">Write</span>(50,*) <span class="stringliteral">&#39;Degen of left  trial wave function: &#39;</span>, <a class="code" href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">wf_l</a>(nf)%Degen</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                   </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">#endif             </span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor"></span>             </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">If</span> (irank_g == 0 )  <span class="keywordflow">then</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor"></span>             <span class="keyword">close</span>(50)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;             <span class="keyword">Close</span>(5)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          endif</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">! #ifdef MPI</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">!           If (Irank == 0 )  then</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">! #endif</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">! #if defined(STAB1) </span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">!              Write(50,*) &#39;STAB1 is defined &#39;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">! #endif</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">! </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">! #if defined(QRREF) </span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">!              Write(50,*) &#39;QRREF is defined &#39;</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">! #endif</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">!              close(50)</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">!              Close(5)</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">! #ifdef MPI</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">!           endif</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">! #endif</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="keywordflow">If</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;LRC&quot;</span> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;             <span class="keyword">Call </span>lrc_set_vij(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>, <a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>, <a class="code" href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">ham_alpha</a>, <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>, <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">If</span> (irank_g == 0 )  <span class="keywordflow">then</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor"></span>                <span class="keyword">Call </span>lrc_print(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>, <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>, <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor"></span><span class="keywordflow">             Endif</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor"></span>             </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacehamiltonian.html#aadd308aa7d53991575550174f86753a8">ham_v</a></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a0774a95b11b5a1f086afd9e0ec141273"><div class="ttname"><a href="namespacehamiltonian.html#a0774a95b11b5a1f086afd9e0ec141273">hamiltonian::op_t</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_t</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00137">Hamiltonian_Examples.f90:137</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a03c917b398d6e8df7361089384c7287b"><div class="ttname"><a href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">hamiltonian::ham_h</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_h</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a643cec8e88998409a6f5ae27915b5e87"><div class="ttname"><a href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">hamiltonian::ltrot</a></div><div class="ttdeci">integer ltrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00144">Hamiltonian_Examples.f90:144</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a77462baf56d2efa9c1d45ef9639ed390"><div class="ttname"><a href="namespacehamiltonian.html#a77462baf56d2efa9c1d45ef9639ed390">hamiltonian::setup_ising_action</a></div><div class="ttdeci">subroutine setup_ising_action</div><div class="ttdoc">Setup bonds and median lattice. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00798">Hamiltonian_Examples.f90:798</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_afc044f61c660f6e51f750b378dd88ff4"><div class="ttname"><a href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">hamiltonian::l2</a></div><div class="ttdeci">integer, private l2</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00153">Hamiltonian_Examples.f90:153</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a38fa1c4cce2a1f8143d5a16fbddea3cf"><div class="ttname"><a href="namespacehamiltonian.html#a38fa1c4cce2a1f8143d5a16fbddea3cf">hamiltonian::symm</a></div><div class="ttdeci">logical symm</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00148">Hamiltonian_Examples.f90:148</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a640dde0b8b9b036b73e855a3feaeb863"><div class="ttname"><a href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">hamiltonian::l1</a></div><div class="ttdeci">integer, private l1</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00153">Hamiltonian_Examples.f90:153</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a837082263f9f0c9dc33bbc733ec52605"><div class="ttname"><a href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">hamiltonian::lattice_type</a></div><div class="ttdeci">character(len=64), private lattice_type</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aaf05c9e78bee7d0e443c116d5d517750"><div class="ttname"><a href="namespacehamiltonian.html#aaf05c9e78bee7d0e443c116d5d517750">hamiltonian::beta</a></div><div class="ttdeci">real(kind=kind(0.d0)), private beta</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a1ff2d175685754a703b58a646b249ff1"><div class="ttname"><a href="namespacehamiltonian.html#a1ff2d175685754a703b58a646b249ff1">hamiltonian::ham_alpha</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_alpha</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00155">Hamiltonian_Examples.f90:155</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5e72b755eecc2d14135adc1cfdb25f53"><div class="ttname"><a href="namespacehamiltonian.html#a5e72b755eecc2d14135adc1cfdb25f53">hamiltonian::thtrot</a></div><div class="ttdeci">integer thtrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00145">Hamiltonian_Examples.f90:145</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5e41bd505d50b7cfcdcdacf78cbe8cd4"><div class="ttname"><a href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">hamiltonian::ham_j</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_j</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_af508f251b4965d458d35546984d69fb2"><div class="ttname"><a href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">hamiltonian::n_fl</a></div><div class="ttdeci">integer n_fl</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00142">Hamiltonian_Examples.f90:142</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a13c80692ce5836cdc65570c6c56b0801"><div class="ttname"><a href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">hamiltonian::ndim</a></div><div class="ttdeci">integer ndim</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00141">Hamiltonian_Examples.f90:141</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a194deafd4e8cee2679b632e61ea9e895"><div class="ttname"><a href="namespacehamiltonian.html#a194deafd4e8cee2679b632e61ea9e895">hamiltonian::checkerboard</a></div><div class="ttdeci">logical, private checkerboard</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00159">Hamiltonian_Examples.f90:159</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a3c2ccadb9ff957e46da6a1b7484755f1"><div class="ttname"><a href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">hamiltonian::wf_l</a></div><div class="ttdeci">type(wavefunction), dimension(:), allocatable wf_l</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00138">Hamiltonian_Examples.f90:138</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a77179b40953aaf13f002b7f4fc0b7456"><div class="ttname"><a href="namespacehamiltonian.html#a77179b40953aaf13f002b7f4fc0b7456">hamiltonian::projector</a></div><div class="ttdeci">logical projector</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00146">Hamiltonian_Examples.f90:146</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a16532e80c0e204e028d3475cda56036e"><div class="ttname"><a href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">hamiltonian::ham_t</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_t</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a04b8d5403685aa76c409005a817aa003"><div class="ttname"><a href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">hamiltonian::ham_xi</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_xi</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_abeb8c11095eba37577f0131f52c49b80"><div class="ttname"><a href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">hamiltonian::ham_u</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_u</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aef693c8b68751ed1e8ffc50b12890e02"><div class="ttname"><a href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">hamiltonian::group_comm</a></div><div class="ttdeci">integer group_comm</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00147">Hamiltonian_Examples.f90:147</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a2b59a5712728c871c3087c4a273e18c8"><div class="ttname"><a href="namespacehamiltonian.html#a2b59a5712728c871c3087c4a273e18c8">hamiltonian::theta</a></div><div class="ttdeci">real(kind=kind(0.d0)), private theta</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a636c1b29569310a368b3377ce1382d8a"><div class="ttname"><a href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">hamiltonian::invlist</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private invlist</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a7e147e50361e67d0692f6f6306be5a17"><div class="ttname"><a href="namespacehamiltonian.html#a7e147e50361e67d0692f6f6306be5a17">hamiltonian::xb_x</a></div><div class="ttdeci">real(kind=kind(0.d0)), private xb_x</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a1e0301588aa05699e0fcfb0d16d4c738"><div class="ttname"><a href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">hamiltonian::ham_tv</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_tv</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a292641502e14286faa4fc4c5e2692ec4"><div class="ttname"><a href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">hamiltonian::list</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private list</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a2fe26506e76f653d380605147a5dd0aa"><div class="ttname"><a href="namespacehamiltonian.html#a2fe26506e76f653d380605147a5dd0aa">hamiltonian::phi_y</a></div><div class="ttdeci">real(kind=kind(0.d0)), private phi_y</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00156">Hamiltonian_Examples.f90:156</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a49efcdbb93b14e202caa847a20e12d3f"><div class="ttname"><a href="namespacehamiltonian.html#a49efcdbb93b14e202caa847a20e12d3f">hamiltonian::xb_y</a></div><div class="ttdeci">real(kind=kind(0.d0)), private xb_y</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00156">Hamiltonian_Examples.f90:156</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a884ce86017041b4ec130264300dfb201"><div class="ttname"><a href="namespacehamiltonian.html#a884ce86017041b4ec130264300dfb201">hamiltonian::phi_x</a></div><div class="ttdeci">real(kind=kind(0.d0)), private phi_x</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adbb663a56d63496d9b9f883e84d527ed"><div class="ttname"><a href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">hamiltonian::wf_r</a></div><div class="ttdeci">type(wavefunction), dimension(:), allocatable wf_r</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00139">Hamiltonian_Examples.f90:139</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aadd308aa7d53991575550174f86753a8"><div class="ttname"><a href="namespacehamiltonian.html#aadd308aa7d53991575550174f86753a8">hamiltonian::ham_v</a></div><div class="ttdeci">subroutine ham_v</div><div class="ttdoc">Sets the interaction. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00577">Hamiltonian_Examples.f90:577</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aac1b1fa8c65688bd7fdbb7c2ce1c73be"><div class="ttname"><a href="namespacehamiltonian.html#aac1b1fa8c65688bd7fdbb7c2ce1c73be">hamiltonian::percent_change</a></div><div class="ttdeci">real(kind=kind(0.d0)), private percent_change</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00155">Hamiltonian_Examples.f90:155</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5d9bca3236ec22ed3f6a789aa662e3b7"><div class="ttname"><a href="namespacehamiltonian.html#a5d9bca3236ec22ed3f6a789aa662e3b7">hamiltonian::ham_chem</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_chem</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aadd308aa7d53991575550174f86753a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadd308aa7d53991575550174f86753a8">&#9670;&nbsp;</a></span>ham_v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::ham_v </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the interaction. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration </dd></dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">577</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_tv</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_u</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_xi</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">invlist</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">l_bond_inv</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">latt_unit</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">lattice_type</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00142">n_fl</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00141">ndim</a>, <a class="el" href="Operator_8f90_source.html#l00184">operator_mod::op_make()</a>, <a class="el" href="Operator_8f90_source.html#l00230">operator_mod::op_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00136">op_v</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="keywordtype">Implicit none</span> </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <span class="keywordtype">Integer</span> :: nf, I, I1, I2,  nc, nc1,  J</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keywordtype">Real (Kind=Kind(0.d0))</span> :: X</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">Select case</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a>)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;LRC&quot;</span>)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;             <span class="keyword">Allocate</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>))</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;             <span class="keywordflow">do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <span class="keywordflow">do</span> i  = 1, <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                   <span class="keyword">Call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,nf),1)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;             <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                nc = 0</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                   nc = nc + 1</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%P(1) = i</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%O(1,1) = cmplx(1.d0  ,0.d0, kind(0.d0))</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%alpha  = cmplx(-0.5d0,0.d0, kind(0.d0))</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%g      = cmplx(0.d0  ,<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>, kind(0.d0)) </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%type   = 3</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                   <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf) )</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_SU2&quot;</span>)  </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;             <span class="comment">!Write(50,*) &#39;Model is &#39;, Model</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;             <span class="keyword">Allocate</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>))</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;             <span class="keywordflow">do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">do</span> i  = 1, <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                   <span class="keyword">Call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,nf),1)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;             <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                nc = 0</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                   nc = nc + 1</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%P(1) = i</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%O(1,1) = cmplx(1.d0  ,0.d0, kind(0.d0))</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%alpha  = cmplx(-0.5d0,0.d0, kind(0.d0))</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                   <span class="comment">!! Three fields</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%g      = sqrt(cmplx(-<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>/(dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)), 0.d0, kind(0.d0))) </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%type   = 2</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                   <span class="comment">!! Hirsch Decomp  *** This is just for testing  type = 3 **   This was just for testing</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                   <span class="comment">!! Op_V(nc,nf)%g      = cmplx(0.d0, acos(exp(-DTAU*ham_U/2.d0)), kind(0.D0)) </span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                   <span class="comment">!! Op_V(nc,nf)%type   = 3</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                   <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf) )</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_Mz&quot;</span>) </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;             <span class="keyword">Allocate</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>))</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;             <span class="keywordflow">do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="keywordflow">do</span> i  = 1, <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                   <span class="keyword">Call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,nf),1)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;             <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                nc = 0</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                x = 1.d0</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="keywordflow">if</span> (nf == 2) x = -1.d0</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                   nc = nc + 1</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%P(1) = i</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%O(1,1) = cmplx(1.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%g      = x*sqrt(cmplx(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>/2.d0, 0.d0, kind(0.d0))) </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%alpha  = cmplx(0.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf)%type   = 2</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                   <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,nf) )</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span>) </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;             <span class="keyword">Allocate</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(3*<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>))</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;             <span class="keywordflow">do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="keywordflow">do</span> i  =  1, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                   <span class="keyword">call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,nf),2)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <span class="keywordflow">do</span> i  = <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a> +1 ,  <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a> + <a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a> <span class="comment">! For Hubbatd</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                   <span class="keyword">Call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,nf),1)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;             <span class="keywordflow">Do</span> nc = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>*<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord   <span class="comment">! Runs over bonds.  Coordination number = 2.</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="comment">! For the square lattice Ndim = Latt%N</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                i1 = <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(nc,1)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                i2 = i1</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(nc,2)  == 1 ) i2 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i1,1,0)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(nc,2)  == 2 ) i2 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i1,0,1)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(1) = i1</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(2) = i2</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(1,2) = cmplx(1.d0 ,0.d0, kind(0.d0)) </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(2,1) = cmplx(1.d0 ,0.d0, kind(0.d0)) </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%g = cmplx(-<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">ham_xi</a>,0.d0,kind(0.d0))</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%alpha = cmplx(0d0,0.d0, kind(0.d0)) </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%type =1</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1) )</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;             </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                nc1 = <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a> + i</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1)%P(1)   = i</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1)%O(1,1) = cmplx(1.d0  ,0.d0, kind(0.d0))</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1)%g      = sqrt(cmplx(-<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a>/(dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)), 0.d0, kind(0.d0)))</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1)%alpha  = cmplx(-0.5d0,0.d0, kind(0.d0))</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1)%type   = 2</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="comment">!!  Hirsch Decomp  *** This is just for testing  type = 3 **</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="comment">!!Op_V(nc1,1)%g      = cmplx(0.d0, acos(exp(-DTAU*ham_U/2.d0)), kind(0.D0)) </span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="comment">!!Op_V(nc1,1)%type   = 3</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc1,1) )</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&quot;t_V&quot;</span>)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;             <span class="keyword">Allocate</span>(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N,1))</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;             <span class="keywordflow">do</span> i  =  1, <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keyword">call </span>op_make(<a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(i,1),2)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;             <span class="keywordflow">select case</span> (<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;             <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Square&quot;</span>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="comment">!Write(6,*) &quot;N_coord, Latt%N&quot;, N_coord, Latt%N, Dtau, ham_tV</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                nc = 0</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                   i1 = i</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                   <span class="keywordflow">do</span> nc1 = 1,<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                      nc = nc + 1</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                      <span class="keywordflow">if</span> (nc1 == 1 ) i2 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,1,0) </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                      <span class="keywordflow">if</span> (nc1 == 2 ) i2 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,0,1)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(1) = i1</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(2) = i2</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(1,2) = cmplx(1.d0 ,0.d0, kind(0.d0)) </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(2,1) = cmplx(1.d0 ,0.d0, kind(0.d0))</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%g      = sqrt(cmplx(-<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a>, 0.d0, kind(0.d0))) </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%alpha  = cmplx(0.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%type   = 2</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                      <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1) )</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">                   Enddo</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;             <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Pi_Flux&quot;</span>)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                nc = 0</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                   i1 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(i,1)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                   <span class="keywordflow">do</span> nc1 = 1,<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                      nc = nc + 1</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                      <span class="keywordflow">If</span> (nc1 == 1 )  i2 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(i,2)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                      <span class="keywordflow">If</span> (nc1 == 2 )  i2 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,0, 1),2) </div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                      <span class="keywordflow">If</span> (nc1 == 3 )  i2 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,-1,1),2)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                      <span class="keywordflow">If</span> (nc1 == 4 )  i2 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,-1,0),2) </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(1) = i1</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%P(2) = i2</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(1,2) = cmplx(1.d0 ,0.d0, kind(0.d0)) </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%O(2,1) = cmplx(1.d0 ,0.d0, kind(0.d0))</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%g     = sqrt(cmplx(-<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">ham_tv</a>, 0.d0, kind(0.d0))) </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%alpha = cmplx(0.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                      <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1)%type  = 2</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                      <span class="keyword">Call </span>op_set( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(nc,1) )</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordflow">                   Enddo</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordflow">             case default</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keyword">Write</span>(6,*) <span class="stringliteral">&quot;Lattice for t-V  not implemented&quot;</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                stop</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keywordflow">             End select</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordflow">          case default</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;             <span class="keyword">Write</span>(6,*) <span class="stringliteral">&quot;Model not yet implemented!&quot;</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;             stop</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordflow">          end Select</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          </div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a837082263f9f0c9dc33bbc733ec52605"><div class="ttname"><a href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">hamiltonian::lattice_type</a></div><div class="ttdeci">character(len=64), private lattice_type</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a84417401f46ecdbfd3ceae3d80578bd4"><div class="ttname"><a href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">hamiltonian::l_bond_inv</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private l_bond_inv</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_af508f251b4965d458d35546984d69fb2"><div class="ttname"><a href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">hamiltonian::n_fl</a></div><div class="ttdeci">integer n_fl</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00142">Hamiltonian_Examples.f90:142</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a13c80692ce5836cdc65570c6c56b0801"><div class="ttname"><a href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">hamiltonian::ndim</a></div><div class="ttdeci">integer ndim</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00141">Hamiltonian_Examples.f90:141</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a04b8d5403685aa76c409005a817aa003"><div class="ttname"><a href="namespacehamiltonian.html#a04b8d5403685aa76c409005a817aa003">hamiltonian::ham_xi</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_xi</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a784fd999e79bf7eea97eb4b7695db65d"><div class="ttname"><a href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">hamiltonian::op_v</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_v</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00136">Hamiltonian_Examples.f90:136</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_abeb8c11095eba37577f0131f52c49b80"><div class="ttname"><a href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">hamiltonian::ham_u</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_u</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a636c1b29569310a368b3377ce1382d8a"><div class="ttname"><a href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">hamiltonian::invlist</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private invlist</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a1e0301588aa05699e0fcfb0d16d4c738"><div class="ttname"><a href="namespacehamiltonian.html#a1e0301588aa05699e0fcfb0d16d4c738">hamiltonian::ham_tv</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_tv</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea2e345f43022b9c6bf72b2d297eaa1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea2e345f43022b9c6bf72b2d297eaa1c">&#9670;&nbsp;</a></span>hamiltonian_set_nsigma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::hamiltonian_set_nsigma </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind(0.d0)), dimension(:,:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>Initial_field</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The user can set the initial field. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[OUT]</td><td>Initial_field Real(:,:) <pre class="fragment">  Upon entry Initial_field is not allocated. If alloacted then it will contain the
  the initial field</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01537">1537</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordtype">Real (Kind=Kind(0.d0))</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">Intent(OUT)</span> :: Initial_field</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<a id="ad66eff667baae554d8db1390d57e2e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad66eff667baae554d8db1390d57e2e24">&#9670;&nbsp;</a></span>init_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::init_obs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ltau</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes observables to zero before each bins. No need to change this routine. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration </dd></dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01413">1413</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00165">obs_eq</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00164">obs_scal</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00166">obs_tau</a>, <a class="el" href="observables__mod_8f90_source.html#l00086">observables::obser_latt_init()</a>, and <a class="el" href="observables__mod_8f90_source.html#l00107">observables::obser_vec_init()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(In)</span> :: Ltau</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          </div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          <span class="comment">! Local </span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordtype">Integer</span> :: I</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>,1)</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;             <span class="keyword">Call </span>obser_vec_init(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i))</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>,1)</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;             <span class="keyword">Call </span>obser_latt_init(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i))</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          <span class="keywordflow">If</span> (ltau == 1) <span class="keywordflow">then</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;             <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>,1)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="keyword">Call </span>obser_latt_init(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="ttc" id="namespacehamiltonian_html_aaed23e3d96cff5fd9c06aee2339c8e11"><div class="ttname"><a href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">hamiltonian::obs_tau</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_tau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00166">Hamiltonian_Examples.f90:166</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aeb09a967466f8b65fd016da2d380cb70"><div class="ttname"><a href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">hamiltonian::obs_eq</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_eq</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00165">Hamiltonian_Examples.f90:165</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a0801e185b65b8a7f74d6963fd2b5e8bf"><div class="ttname"><a href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">hamiltonian::obs_scal</a></div><div class="ttdeci">type(obser_vec), dimension(:), allocatable, private obs_scal</div><div class="ttdoc">Privat Observables. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00164">Hamiltonian_Examples.f90:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7512891175f70d6103bfcfea844933d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7512891175f70d6103bfcfea844933d6">&#9670;&nbsp;</a></span>obser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::obser </td>
          <td>(</td>
          <td class="paramtype">complex (kind=kind(0.d0)), dimension(<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>GR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), intent(in)&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ntau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes equal time observables. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[IN]</td><td>Gr Complex(:,:,:) <pre class="fragment">  Green function: Gr(I,J,nf) = &lt;c_{I,nf } c^{dagger}_{J,nf } &gt; on time slice ntau</pre> </td></tr>
    <tr><td class="paramname">[IN]</td><td>Phase Complex <pre class="fragment">  Phase  </pre> </td></tr>
    <tr><td class="paramname">[IN]</td><td>Ntau Integer <pre class="fragment">  Time slice </pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">1101</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_t</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_u</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">invlist</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">latt_unit</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">lattice_type</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">list</a>, <a class="el" href="LRC__mod_8f90_source.html#l00105">lrc_mod::lrc_v_int()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00165">obs_eq</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00164">obs_scal</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          </div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          </div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: GR(Ndim,Ndim,N_FL)</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span>, <span class="keywordtype">Intent(IN)</span> :: PHASE</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">INTENT(IN)</span>          :: Ntau</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          <span class="comment">!Local </span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span> :: GRC(Ndim,Ndim,N_FL), ZK</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span> :: Zrho, Zkin, ZPot, Z, ZP,ZS, ZZ, ZXY</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          <span class="keywordtype">Integer</span> :: I,J, imj, nf, dec, I1, J1, no_I, no_J,n</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          </div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          zp = phase/<span class="keywordtype">Real</span>(Phase, kind(0.D0))</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          zs = <span class="keywordtype">Real</span>(Phase, kind(0.D0))/Abs(<span class="keywordtype">Real</span>(Phase, kind(0.D0)))</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="keywordflow">Do</span> j = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                   grc(i, j, nf) = -gr(j, i, nf)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                grc(i, i, nf) = 1.d0 + grc(i, i, nf)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;          <span class="comment">! GRC(i,j,nf) = &lt; c^{dagger}_{j,nf } c_{j,nf } &gt;</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <span class="comment">! Compute scalar observables. </span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>,1)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;             <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i)%N         =  <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i)%N + 1</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;             <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i)%Ave_sign  =  <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i)%Ave_sign + <span class="keywordtype">Real</span>(ZS,kind(0.d0))</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;             </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          zkin = cmplx(0.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="keywordflow">Do</span> n = 1,<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                   <span class="keywordflow">Select Case</span> (<a class="code" href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">lattice_type</a>)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                   <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Square&quot;</span>)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                      i1 = i</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                      <span class="keywordflow">If</span> (n == 1)  j1 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,1,0)</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                      <span class="keywordflow">If</span> (n == 2)  j1 = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,0,1)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                   <span class="keywordflow">Case</span> (<span class="stringliteral">&quot;Honeycomb&quot;</span>)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                      i1 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(i,1) </div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                      <span class="keywordflow">If</span> (n == 1)  j1 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(i,2)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                      <span class="keywordflow">If</span> (n == 2)  j1 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,1,-1),2)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                      <span class="keywordflow">If</span> (n == 3)  j1 = <a class="code" href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">invlist</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,0,-1),2)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keywordflow">                   Case Default</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                      stop</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="keywordflow">                   end Select</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                   zkin = zkin +  grc( i1,j1, nf ) + grc(j1,i1,nf)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          zkin = -<a class="code" href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">ham_t</a>*zkin * dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(1)%Obs_vec(1)  =    <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(1)%Obs_vec(1) + zkin *zp* zs</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          zpot = cmplx(0.d0, 0.d0, kind(0.d0))</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span> ) <span class="keywordflow">then</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;             dec = 1</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                zpot = zpot + grc(i,i,1) * grc(i,i, dec)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;             zpot = zpot*<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          <span class="keywordflow">elseif</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_MZ&quot;</span>) <span class="keywordflow">then</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;             dec = 2</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                zpot = zpot + grc(i,i,1) * grc(i,i, dec)</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;             zpot = zpot*<a class="code" href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">ham_u</a></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          <span class="keywordflow">elseif</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;LRC&quot;</span>) <span class="keywordflow">then</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;             z =  cmplx(dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>), 0.d0, kind(0.d0))</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                zpot = zpot +    lrc_v_int(i,i)* grc(i,i, 1)* grc(i,i,1) </div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="keywordflow">Do</span> j = i+1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                   zpot = zpot + z*lrc_v_int(i,j)*(z *  grc(i,i, 1)* grc(j,j,1)  + grc(i,j,1)*gr(i,j,1) )</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(2)%Obs_vec(1)  =  <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(2)%Obs_vec(1) + zpot * zp*zs</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          zrho = cmplx(0.d0,0.d0, kind(0.d0))</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <span class="keywordflow">Do</span> nf = 1,<a class="code" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;             <span class="keywordflow">Do</span> i = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                zrho = zrho + grc(i,i,nf) </div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          zrho = zrho* dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(3)%Obs_vec(1)  =    <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(3)%Obs_vec(1) + zrho * zp*zs</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;          <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(4)%Obs_vec(1)  =    <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(4)%Obs_vec(1) + (zkin + zpot)*zp*zs</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          <span class="comment">! Compute spin-spin, Green, and den-den correlation functions  !  This is general N_SUN, and  N_FL = 1</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <span class="keywordflow">DO</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>,1)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;             <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i)%N        = <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i)%N + 1</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;             <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i)%Ave_sign = <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i)%Ave_sign + <span class="keywordtype">real</span>(ZS,kind(0.d0))</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">          ENDDO</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;t_V&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a>== <span class="stringliteral">&quot;LRC&quot;</span>  ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;             z =  cmplx(dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>), 0.d0, kind(0.d0))</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;             <span class="keywordflow">Do</span> i1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                i    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,1)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                no_i = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,2)</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <span class="keywordflow">Do</span> j1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                   j    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,1)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                   no_j = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,2)</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                   imj = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%imj(i,j)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                   <span class="comment">! Green</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(1)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(1)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        &amp;               z * grc(i1,j1,1) *  zp*zs </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                   <span class="comment">! SpinZ</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(2)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(2)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        &amp;               z * grc(i1,j1,1) * gr(i1,j1,1) * zp*zs</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                   <span class="comment">! SpinXY</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(3)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(3)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        &amp;               z * grc(i1,j1,1) * gr(i1,j1,1) * zp*zs</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                   <span class="comment">! SpinT</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(5)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(5)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                        &amp;               z * grc(i1,j1,1) * gr(i1,j1,1) * zp*zs</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                   <span class="comment">! Den</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt(imj,1,no_i,no_j)  +  &amp;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                        &amp;     (    grc(i1,i1,1) * grc(j1,j1,1) *z     + &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                        &amp;          grc(i1,j1,1) * gr(i1,j1,1 )           &amp;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                        &amp;                                   ) * z* zp*zs</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="keywordflow">                ENDDO</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt0(no_i) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt0(no_i) +  z * grc(i1,i1,1) * zp * zs</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">             ENDDO</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          <span class="keywordflow">elseif</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_Mz&quot;</span> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;             <span class="keywordflow">Do</span> i1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                i    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,1)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                no_i = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,2)</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                <span class="keywordflow">Do</span> j1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                   j    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,1)</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                   no_j = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,2)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                   imj = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%imj(i,j)</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                   <span class="comment">! Green</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(1)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(1)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        &amp;                          ( grc(i1,j1,1) + grc(i1,j1,2)) *  zp*zs </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                   <span class="comment">! SpinZ</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                   zz =       grc(i1,j1,1) * gr(i1,j1,1) +  grc(i1,j1,2) * gr(i1,j1,2)    + &amp;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                        &amp;    (grc(i1,i1,2) - grc(i1,i1,1))*(grc(j1,j1,2) - grc(j1,j1,1))  </div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(2)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(2)%Obs_Latt(imj,1,no_i,no_j) + zz* zp*zs</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                   <span class="comment">! SpinXY</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                   <span class="comment">! c^d_(i,u) c_(i,d) c^d_(j,d) c_(j,u)  +  c^d_(i,d) c_(i,u) c^d_(j,u) c_(j,d)</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                   zxy =  grc(i1,j1,1) * gr(i1,j1,2) +  grc(i1,j1,2) * gr(i1,j1,1) </div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(3)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(3)%Obs_Latt(imj,1,no_i,no_j) + zxy* zp*zs</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                   <span class="comment">! SpinT</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(5)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(5)%Obs_Latt(imj,1,no_i,no_j) + (2.d0*zxy + zz)*zp*zs/3.d0</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                   <span class="comment">!Den</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt(imj,1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt(imj,1,no_i,no_j) + &amp;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                        &amp; (   grc(i1,j1,1) * gr(i1,j1,1) +  grc(i1,j1,2) * gr(i1,j1,2)    + &amp;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                        &amp;   (grc(i1,i1,2) + grc(i1,i1,1))*(grc(j1,j1,2) + grc(j1,j1,1))     ) * zp*zs</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt0(no_i) =  <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(4)%Obs_Latt0(no_i) +  (grc(i1,i1,1) + grc(i1,i1,2)) * zp*zs</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                </div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="ttc" id="namespacehamiltonian_html_a837082263f9f0c9dc33bbc733ec52605"><div class="ttname"><a href="namespacehamiltonian.html#a837082263f9f0c9dc33bbc733ec52605">hamiltonian::lattice_type</a></div><div class="ttdeci">character(len=64), private lattice_type</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_af508f251b4965d458d35546984d69fb2"><div class="ttname"><a href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">hamiltonian::n_fl</a></div><div class="ttdeci">integer n_fl</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00142">Hamiltonian_Examples.f90:142</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a13c80692ce5836cdc65570c6c56b0801"><div class="ttname"><a href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">hamiltonian::ndim</a></div><div class="ttdeci">integer ndim</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00141">Hamiltonian_Examples.f90:141</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aeb09a967466f8b65fd016da2d380cb70"><div class="ttname"><a href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">hamiltonian::obs_eq</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_eq</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00165">Hamiltonian_Examples.f90:165</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a16532e80c0e204e028d3475cda56036e"><div class="ttname"><a href="namespacehamiltonian.html#a16532e80c0e204e028d3475cda56036e">hamiltonian::ham_t</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_t</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a0801e185b65b8a7f74d6963fd2b5e8bf"><div class="ttname"><a href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">hamiltonian::obs_scal</a></div><div class="ttdeci">type(obser_vec), dimension(:), allocatable, private obs_scal</div><div class="ttdoc">Privat Observables. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00164">Hamiltonian_Examples.f90:164</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_abeb8c11095eba37577f0131f52c49b80"><div class="ttname"><a href="namespacehamiltonian.html#abeb8c11095eba37577f0131f52c49b80">hamiltonian::ham_u</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_u</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a636c1b29569310a368b3377ce1382d8a"><div class="ttname"><a href="namespacehamiltonian.html#a636c1b29569310a368b3377ce1382d8a">hamiltonian::invlist</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private invlist</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a292641502e14286faa4fc4c5e2692ec4"><div class="ttname"><a href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">hamiltonian::list</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private list</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62fbb052f8da280932ee0a5332531f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62fbb052f8da280932ee0a5332531f58">&#9670;&nbsp;</a></span>obsert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::obsert </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), dimension(<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>GT0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), dimension(<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>G0T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), dimension(<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>G00</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), dimension(<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a>,<a class="el" href="namespacehamiltonian.html#af508f251b4965d458d35546984d69fb2">n_fl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>GTT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex (kind=kind(0.d0)), intent(in)&#160;</td>
          <td class="paramname"><em>PHASE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes time displaced observables. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[IN]</td><td>NT, Integer <pre class="fragment">  Imaginary time</pre> </td></tr>
    <tr><td class="paramname">[IN]</td><td>GT0, GTT, G00, GTT, Complex(:,:,:) <pre class="fragment">  Green functions:
  GT0(I,J,nf) = &lt;T c_{I,nf }(tau) c^{dagger}_{J,nf }(0  )&gt; 
  G0T(I,J,nf) = &lt;T c_{I,nf }(0  ) c^{dagger}_{J,nf }(tau)&gt; 
  G00(I,J,nf) = &lt;T c_{I,nf }(0  ) c^{dagger}_{J,nf }(0  )&gt; 
  GTT(I,J,nf) = &lt;T c_{I,nf }(tau) c^{dagger}_{J,nf }(tau)&gt; </pre> </td></tr>
    <tr><td class="paramname">[IN]</td><td>Phase Complex <pre class="fragment">  Phase  </pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">1288</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">list</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00166">obs_tau</a>.</p>

<p class="reference">Referenced by <a class="el" href="tau__m_8f90_source.html#l00053">tau_m_mod::tau_m()</a>, and <a class="el" href="tau__p_8f90_source.html#l00055">tau_p_mod::tau_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          </div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          <span class="keywordtype">Integer</span>         , <span class="keywordtype">INTENT(IN)</span> :: NT</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: GT0(Ndim,Ndim,N_FL),G0T(Ndim,Ndim,N_FL),G00(Ndim,Ndim,N_FL),GTT(Ndim,Ndim,N_FL)</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: Phase</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="comment">!Locals</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          <span class="keywordtype">Complex (Kind=Kind(0.d0))</span> :: Z, ZP, ZS</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          <span class="keywordtype">Integer</span> :: IMJ, I, J, I1, J1, no_I, no_J</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          zp = phase/<span class="keywordtype">Real</span>(Phase, kind(0.D0))</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          zs = <span class="keywordtype">Real</span>(Phase, kind(0.D0))/Abs(<span class="keywordtype">Real</span>(Phase, kind(0.D0)))</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <span class="keywordflow">If</span> (nt == 0 ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;             <span class="keywordflow">DO</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>,1)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i)%N = <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i)%N + 1</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i)%Ave_sign = <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i)%Ave_sign + <span class="keywordtype">Real</span>(ZS,kind(0.d0))</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="keywordflow">             ENDDO</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;          <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_SU2_Ising&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;t_V&quot;</span> .or. <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;LRC&quot;</span>  ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;             z =  cmplx(dble(<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>),0.d0, kind(0.d0))</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;             <span class="keywordflow">Do</span> i1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                i    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,1)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                no_i = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,2)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                <span class="keywordflow">Do</span> j1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                   j    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,1)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                   no_j = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,2)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                   imj = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%imj(i,j)</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                   <span class="comment">! Green</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(1)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(1)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                        &amp; +  z * gt0(i1,j1,1) * zp* zs</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                   </div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                   <span class="comment">! SpinZ</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(2)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(2)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        &amp;      - z*g0t(j1,i1,1) * gt0(i1,j1,1) *zp*zs</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                   </div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                   <span class="comment">! SpinXY</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(3)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(3)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        &amp;      - z*g0t(j1,i1,1) * gt0(i1,j1,1) *zp*zs</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                   </div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                   <span class="comment">! Den</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        &amp; + ( z*z*(cmplx(1.d0,0.d0,kind(0.d0)) - gtt(i1,i1,1))*       &amp;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                        &amp;         (cmplx(1.d0,0.d0,kind(0.d0)) - g00(j1,j1,1))  -     &amp;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                        &amp;     z * gt0(i1,j1,1)*g0t(j1,i1,1)                                ) * zp * zs</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt0(no_i) = <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt0(no_i) + &amp;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                     &amp;         z*(cmplx(1.d0,0.d0,kind(0.d0)) - gtt(i1,i1,1)) * zp * zs</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          <span class="keywordflow">Elseif</span> ( <a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;Hubbard_Mz&quot;</span>  ) <span class="keywordflow">then</span> </div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;             <span class="keywordflow">Do</span> i1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                i    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,1)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                no_i = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(i1,2)</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                <span class="keywordflow">Do</span> j1 = 1,<a class="code" href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">ndim</a></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                   j    = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,1)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                   no_j = <a class="code" href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">list</a>(j1,2)</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                   imj = <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%imj(i,j)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                   <span class="comment">!Green</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(1)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(1)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        &amp;   +   ( gt0(i1,j1,1) + gt0(i1,j1,2) ) * zp* zs</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                   <span class="comment">!SpinZ</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(2)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(2)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                       &amp; +  ( &amp;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                       &amp;    (gtt(i1,i1,1) -  gtt(i1,i1,2) ) * ( g00(j1,j1,1)  -  g00(j1,j1,2) )   &amp;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                       &amp;  - (g0t(j1,i1,1) * gt0(i1,j1,1)  +  g0t(j1,i1,2) * gt0(i1,j1,2) )    )*zp*zs</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                   <span class="comment">!SpinXY</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(3)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(3)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        &amp;  - &amp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                        &amp;   (g0t(j1,i1,1) * gt0(i1,j1,2)  +  g0t(j1,i1,2) * gt0(i1,j1,1))*zp*zs</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                   <span class="comment">!Den</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt(imj,nt+1,no_i,no_j) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt(imj,nt+1,no_i,no_j)  &amp;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                        &amp; +  (                                        &amp;  </div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                        &amp;    (cmplx(2.d0,0.d0,kind(0.d0)) - gtt(i1,i1,1) - gtt(i1,i1,2) ) * &amp;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                        &amp;    (cmplx(2.d0,0.d0,kind(0.d0)) - g00(j1,j1,1) - g00(j1,j1,2) )   &amp;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                        &amp; -  ( g0t(j1,i1,1) * gt0(i1,j1,1) + g0t(j1,i1,2) * gt0(i1,j1,2) )  )*zp*zs     </div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keywordflow">                enddo</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;             </div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt0(no_i) =  <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(4)%Obs_Latt0(no_i) + &amp;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                     &amp;       (cmplx(2.d0,0.d0,kind(0.d0)) - gtt(i1,i1,1) - gtt(i1,i1,2)) * zp * zs</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;          </div><div class="ttc" id="namespacehamiltonian_html_aaed23e3d96cff5fd9c06aee2339c8e11"><div class="ttname"><a href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">hamiltonian::obs_tau</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_tau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00166">Hamiltonian_Examples.f90:166</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a13c80692ce5836cdc65570c6c56b0801"><div class="ttname"><a href="namespacehamiltonian.html#a13c80692ce5836cdc65570c6c56b0801">hamiltonian::ndim</a></div><div class="ttdeci">integer ndim</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00141">Hamiltonian_Examples.f90:141</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a292641502e14286faa4fc4c5e2692ec4"><div class="ttname"><a href="namespacehamiltonian.html#a292641502e14286faa4fc4c5e2692ec4">hamiltonian::list</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private list</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00160">Hamiltonian_Examples.f90:160</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e41e35f2eb6cbc0ecb4333731a265a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e41e35f2eb6cbc0ecb4333731a265a0">&#9670;&nbsp;</a></span>pr_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::pr_obs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LTAU</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints out the bins. No need to change this routine. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration </dd></dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">1381</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00147">group_comm</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00165">obs_eq</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00164">obs_scal</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00166">obs_tau</a>, <a class="el" href="observables__mod_8f90_source.html#l00117">observables::print_bin_latt()</a>, and <a class="el" href="observables__mod_8f90_source.html#l00229">observables::print_bin_vec()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="keywordtype">Integer</span>,  <span class="keywordtype">Intent(In)</span> ::  Ltau</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          </div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          <span class="comment">!Local </span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="keywordtype">Integer</span> :: I</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>,1)</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;             <span class="keyword">Call  </span>print_bin_vec(<a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a>(i),<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>)</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>,1)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;             <span class="keyword">Call  </span>print_bin_latt(<a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a>(i),<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>,<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>)</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          <span class="keywordflow">If</span> (ltau  == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;             <span class="keywordflow">Do</span> i = 1,<span class="keyword">Size</span>(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>,1)</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                <span class="keyword">Call  </span>print_bin_latt(<a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a>(i),<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>,<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">group_comm</a>)</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="ttc" id="namespacehamiltonian_html_aaed23e3d96cff5fd9c06aee2339c8e11"><div class="ttname"><a href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">hamiltonian::obs_tau</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_tau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00166">Hamiltonian_Examples.f90:166</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aeb09a967466f8b65fd016da2d380cb70"><div class="ttname"><a href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">hamiltonian::obs_eq</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_eq</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00165">Hamiltonian_Examples.f90:165</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a0801e185b65b8a7f74d6963fd2b5e8bf"><div class="ttname"><a href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">hamiltonian::obs_scal</a></div><div class="ttdeci">type(obser_vec), dimension(:), allocatable, private obs_scal</div><div class="ttdoc">Privat Observables. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00164">Hamiltonian_Examples.f90:164</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_aef693c8b68751ed1e8ffc50b12890e02"><div class="ttname"><a href="namespacehamiltonian.html#aef693c8b68751ed1e8ffc50b12890e02">hamiltonian::group_comm</a></div><div class="ttdeci">integer group_comm</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00147">Hamiltonian_Examples.f90:147</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6204b6ca97dda3a87a78d4cebbd7fb2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6204b6ca97dda3a87a78d4cebbd7fb2f">&#9670;&nbsp;</a></span>s0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)) function hamiltonian::s0 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind(0.d0)), intent(in)&#160;</td>
          <td class="paramname"><em>Hs_new</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single spin flip S0 ratio. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<p>S0=exp(-S0(new))/exp(-S0(old)) where the new configuration correpsonds to the old one up to a spin flip of Operator n on time slice nt</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Operator index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>Time slice</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hs_new</td><td>New local field on time slice nt and operator index n </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">755</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">dw_ising_space</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">dw_ising_tau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">ising_nnlist</a>, <a class="el" href="LRC__mod_8f90_source.html#l00354">lrc_mod::lrc_s0()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00144">ltrot</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">model</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">n_sun</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00140">nsigma</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00136">op_v</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00178">wrapgr_mod::wrapgrdo()</a>, and <a class="el" href="Wrapgr__mod_8f90_source.html#l00079">wrapgr_mod::wrapgrup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          <span class="keywordtype">Implicit none</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(IN)</span> :: n</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(IN)</span> :: nt</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <span class="keywordtype">Real (Kind=Kind(0.d0))</span>, <span class="keywordtype">Intent(In)</span> :: Hs_new</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <span class="keywordtype">Integer</span> :: nt1,I</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          <span class="comment">!Write(6,*) &quot;Hi1&quot;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> = 1.d0</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          <span class="keywordflow">If</span> ( <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a>(n,1)%type == 1 ) <span class="keywordflow">then</span> </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;             <span class="keywordflow">do</span> i = 1,4</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> = <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a>*<a class="code" href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">dw_ising_space</a>(<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(<a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,i),nt))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keywordflow">             enddo</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;             nt1 = nt +1 </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;             <span class="keywordflow">if</span> (nt1 &gt; <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a>) nt1 = 1</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;             <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> = <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a>*<a class="code" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a>(<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n,nt1))</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;             nt1 = nt - 1 </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;             <span class="keywordflow">if</span> (nt1 &lt; 1  ) nt1 = <a class="code" href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">ltrot</a></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;             <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> = <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a>*<a class="code" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a>(<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n,nt)*<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%i(n,nt1))</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;             <span class="keywordflow">If</span> (<a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> &lt; 0.d0) <span class="keyword">Write</span>(6,*) <span class="stringliteral">&#39;S0 : &#39;</span>, <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          <span class="keywordflow">If</span> (<a class="code" href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">model</a> == <span class="stringliteral">&quot;LRC&quot;</span> ) <span class="keywordflow">then</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;             <span class="comment">!Write(6,*) &quot;Hi2&quot;</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;             <a class="code" href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">s0</a> = lrc_s0(n,<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>,<a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a>%f(:,nt),hs_new,<a class="code" href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">n_sun</a>)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="keywordflow">          Endif</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          </div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a955eb1417641b40fe24365752fc63942"><div class="ttname"><a href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">hamiltonian::ising_nnlist</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private ising_nnlist</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a643cec8e88998409a6f5ae27915b5e87"><div class="ttname"><a href="namespacehamiltonian.html#a643cec8e88998409a6f5ae27915b5e87">hamiltonian::ltrot</a></div><div class="ttdeci">integer ltrot</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00144">Hamiltonian_Examples.f90:144</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6ab5e538e523c3d4ddf90cda19ee2532"><div class="ttname"><a href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">hamiltonian::dw_ising_tau</a></div><div class="ttdeci">real(kind=kind(0.d0)), dimension(-1:1), private dw_ising_tau</div><div class="ttdoc">Storage for the Ising action. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00169">Hamiltonian_Examples.f90:169</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a47e39398314b7c8194c8736008fc447c"><div class="ttname"><a href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">hamiltonian::nsigma</a></div><div class="ttdeci">class(fields), allocatable nsigma</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00140">Hamiltonian_Examples.f90:140</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_adfb1ed1c4713279c8bd31e28fffa57b9"><div class="ttname"><a href="namespacehamiltonian.html#adfb1ed1c4713279c8bd31e28fffa57b9">hamiltonian::model</a></div><div class="ttdeci">character(len=64), private model</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00158">Hamiltonian_Examples.f90:158</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a784fd999e79bf7eea97eb4b7695db65d"><div class="ttname"><a href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">hamiltonian::op_v</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_v</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00136">Hamiltonian_Examples.f90:136</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6204b6ca97dda3a87a78d4cebbd7fb2f"><div class="ttname"><a href="namespacehamiltonian.html#a6204b6ca97dda3a87a78d4cebbd7fb2f">hamiltonian::s0</a></div><div class="ttdeci">real(kind=kind(0.d0)) function s0(n, nt, Hs_new)</div><div class="ttdoc">Single spin flip S0 ratio. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00755">Hamiltonian_Examples.f90:755</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_abbad453b0abfe8529f92f6c505fdddbc"><div class="ttname"><a href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">hamiltonian::dw_ising_space</a></div><div class="ttdeci">real(kind=kind(0.d0)), dimension(-1:1), private dw_ising_space</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00169">Hamiltonian_Examples.f90:169</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ac8b556cb31a51119226fa1b1afa87eb1"><div class="ttname"><a href="namespacehamiltonian.html#ac8b556cb31a51119226fa1b1afa87eb1">hamiltonian::n_sun</a></div><div class="ttdeci">integer n_sun</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00143">Hamiltonian_Examples.f90:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77462baf56d2efa9c1d45ef9639ed390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77462baf56d2efa9c1d45ef9639ed390">&#9670;&nbsp;</a></span>setup_ising_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hamiltonian::setup_ising_action </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup bonds and median lattice. </p>
<dl class="section author"><dt>Author</dt><dd>ALF Collaboration</dd></dl>
<p>Note that the median lattice on which the Ising bond fields are defined could be defined generally in the predefined lattice subroutine. </p>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">798</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">References <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">dtau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">dw_ising_space</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">dw_ising_tau</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_h</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">ham_j</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">ising_nnlist</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">l1</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">l2</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">l_bond</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">l_bond_inv</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">latt</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">latt_unit</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>
<div class="fragment"><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          <span class="comment">! This subroutine sets up lists and arrays so as to enable an </span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          <span class="comment">! an efficient calculation of  S0(n,nt) </span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          <span class="keywordtype">Integer</span> :: nc, nth, n, n1, n2, n3, n4, I, I1, n_orientation</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          <span class="keywordtype">Real (Kind=Kind(0.d0))</span> :: X_p(2)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          <span class="comment">! Setup list of bonds for the square lattice.</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          <span class="keyword">Allocate</span> (<a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N,2),  <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N*<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord,2) )</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;          </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;          nc = 0</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;          <span class="keywordflow">do</span> nth = 1,2*<a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a>%N_coord  </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;             <span class="keywordflow">Do</span> n1= 1, <a class="code" href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">l1</a>/2</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">Do</span> n2 = 1,<a class="code" href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">l2</a></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                   nc = nc + 1</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                   n_orientation = 1</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                   i1 = 1</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                   <span class="keywordflow">If</span> (nth == 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                      x_p = dble(2*n1)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a1_p + dble(n2)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a2_p </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                      i1 = inv_r(x_p,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>)</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                      n_orientation = 1</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                   <span class="keywordflow">elseif</span> (nth == 2) <span class="keywordflow">then</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                      x_p = dble(2*n1)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a1_p + dble(n2)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a2_p  + <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a1_p</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                      i1 = inv_r(x_p,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                      n_orientation = 1</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                   <span class="keywordflow">elseif</span> (nth == 3) <span class="keywordflow">then</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                      x_p = dble(n2)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a1_p + dble(2*n1)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a2_p </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                      i1 = inv_r(x_p,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                      n_orientation = 2</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                   <span class="keywordflow">elseif</span> (nth == 4) <span class="keywordflow">then</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                      x_p = dble(n2)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a1_p + dble(2*n1)*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a2_p  + <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%a2_p</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                      i1 = inv_r(x_p,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                      n_orientation = 2</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(i1,n_orientation) = nc</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(nc,1) = i1  </div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                   <a class="code" href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">l_bond_inv</a>(nc,2) = n_orientation </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                   <span class="comment">! The bond is given by  I1, I1 + a_(n_orientation).</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">                Enddo</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">             Enddo</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordflow">          Enddo</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="comment">! Setup the nearest neigbour lists for the Ising spins. </span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          <span class="keyword">allocate</span>(<a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(2*<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N,4)) </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <span class="keywordflow">do</span> i  = 1,<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%N</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;             n  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(i,1)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;             n1 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 1, 0),2)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;             n2 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 0, 0),2)</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;             n3 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 0,-1),2)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;             n4 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 1,-1),2)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,1) = n1</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,2) = n2</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,3) = n3</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,4) = n4</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;             n  = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(i,2)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;             n1 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 0, 1),1)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;             n2 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,-1, 1),1)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;             n3 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i,-1, 0),1)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;             n4 = <a class="code" href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">l_bond</a>(<a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a>%nnlist(i, 0, 0),1)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,1) = n1</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,2) = n2</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,3) = n3</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;             <a class="code" href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">ising_nnlist</a>(n,4) = n4</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          <a class="code" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a>( 1) = tanh(<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">ham_h</a>)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          <a class="code" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a>(-1) = 1.d0/<a class="code" href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">dw_ising_tau</a>(1)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <a class="code" href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">dw_ising_space</a>( 1) = exp(-2.d0*<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a>) </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <a class="code" href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">dw_ising_space</a>(-1) = exp( 2.d0*<a class="code" href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">dtau</a>*<a class="code" href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">ham_j</a>) </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          </div><div class="ttc" id="namespacehamiltonian_html_a66daa09f7b7596fa7677e04491f81a37"><div class="ttname"><a href="namespacehamiltonian.html#a66daa09f7b7596fa7677e04491f81a37">hamiltonian::dtau</a></div><div class="ttdeci">real(kind=kind(0.d0)), private dtau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00157">Hamiltonian_Examples.f90:157</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a955eb1417641b40fe24365752fc63942"><div class="ttname"><a href="namespacehamiltonian.html#a955eb1417641b40fe24365752fc63942">hamiltonian::ising_nnlist</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private ising_nnlist</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a03c917b398d6e8df7361089384c7287b"><div class="ttname"><a href="namespacehamiltonian.html#a03c917b398d6e8df7361089384c7287b">hamiltonian::ham_h</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_h</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_afc044f61c660f6e51f750b378dd88ff4"><div class="ttname"><a href="namespacehamiltonian.html#afc044f61c660f6e51f750b378dd88ff4">hamiltonian::l2</a></div><div class="ttdeci">integer, private l2</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00153">Hamiltonian_Examples.f90:153</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a640dde0b8b9b036b73e855a3feaeb863"><div class="ttname"><a href="namespacehamiltonian.html#a640dde0b8b9b036b73e855a3feaeb863">hamiltonian::l1</a></div><div class="ttdeci">integer, private l1</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00153">Hamiltonian_Examples.f90:153</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a84417401f46ecdbfd3ceae3d80578bd4"><div class="ttname"><a href="namespacehamiltonian.html#a84417401f46ecdbfd3ceae3d80578bd4">hamiltonian::l_bond_inv</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private l_bond_inv</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6ab5e538e523c3d4ddf90cda19ee2532"><div class="ttname"><a href="namespacehamiltonian.html#a6ab5e538e523c3d4ddf90cda19ee2532">hamiltonian::dw_ising_tau</a></div><div class="ttdeci">real(kind=kind(0.d0)), dimension(-1:1), private dw_ising_tau</div><div class="ttdoc">Storage for the Ising action. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00169">Hamiltonian_Examples.f90:169</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a67d850ae847d6fe0593ee4b4c61423c6"><div class="ttname"><a href="namespacehamiltonian.html#a67d850ae847d6fe0593ee4b4c61423c6">hamiltonian::l_bond</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, private l_bond</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00170">Hamiltonian_Examples.f90:170</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a5e41bd505d50b7cfcdcdacf78cbe8cd4"><div class="ttname"><a href="namespacehamiltonian.html#a5e41bd505d50b7cfcdcdacf78cbe8cd4">hamiltonian::ham_j</a></div><div class="ttdeci">real(kind=kind(0.d0)), private ham_j</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00154">Hamiltonian_Examples.f90:154</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_abbad453b0abfe8529f92f6c505fdddbc"><div class="ttname"><a href="namespacehamiltonian.html#abbad453b0abfe8529f92f6c505fdddbc">hamiltonian::dw_ising_space</a></div><div class="ttdeci">real(kind=kind(0.d0)), dimension(-1:1), private dw_ising_space</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00169">Hamiltonian_Examples.f90:169</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aaf05c9e78bee7d0e443c116d5d517750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf05c9e78bee7d0e443c116d5d517750">&#9670;&nbsp;</a></span>beta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::beta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">157</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a194deafd4e8cee2679b632e61ea9e895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194deafd4e8cee2679b632e61ea9e895">&#9670;&nbsp;</a></span>checkerboard</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private hamiltonian::checkerboard</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00159">159</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a66daa09f7b7596fa7677e04491f81a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66daa09f7b7596fa7677e04491f81a37">&#9670;&nbsp;</a></span>dtau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::dtau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">157</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordtype">real (Kind=Kind(0.d0))</span>,        <span class="keywordtype">private</span> :: Dtau, Beta, Theta</div></div><!-- fragment -->
</div>
</div>
<a id="abbad453b0abfe8529f92f6c505fdddbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbad453b0abfe8529f92f6c505fdddbc">&#9670;&nbsp;</a></span>dw_ising_space</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), dimension(-1:1), private hamiltonian::dw_ising_space</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">169</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="a6ab5e538e523c3d4ddf90cda19ee2532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab5e538e523c3d4ddf90cda19ee2532">&#9670;&nbsp;</a></span>dw_ising_tau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), dimension(-1:1), private hamiltonian::dw_ising_tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the Ising action. </p>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00169">169</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordtype">Real (Kind=Kind(0.d0))</span>,  <span class="keywordtype">private</span> :: DW_Ising_tau(-1:1), DW_Ising_Space(<span class="comment">-1:1)</span></div><span class="comment"></div><!-- fragment -->
</div>
</div>
<a id="aef693c8b68751ed1e8ffc50b12890e02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef693c8b68751ed1e8ffc50b12890e02">&#9670;&nbsp;</a></span>group_comm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::group_comm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00147">147</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="inconfc_8f90_source.html#l00035">confin()</a>, <a class="el" href="outconfc_8f90_source.html#l00036">confout()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Global__mod_8f90_source.html#l01011">global_mod::global_tempering_pr()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">Integer</span>              :: Group_Comm</div></div><!-- fragment -->
</div>
</div>
<a id="a1ff2d175685754a703b58a646b249ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff2d175685754a703b58a646b249ff1">&#9670;&nbsp;</a></span>ham_alpha</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_alpha</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00155">155</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">real (Kind=Kind(0.d0))</span>,        <span class="keywordtype">private</span> :: ham_alpha, Percent_change</div></div><!-- fragment -->
</div>
</div>
<a id="a5d9bca3236ec22ed3f6a789aa662e3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9bca3236ec22ed3f6a789aa662e3b7">&#9670;&nbsp;</a></span>ham_chem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_chem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a03c917b398d6e8df7361089384c7287b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c917b398d6e8df7361089384c7287b">&#9670;&nbsp;</a></span>ham_h</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="a5e41bd505d50b7cfcdcdacf78cbe8cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e41bd505d50b7cfcdcdacf78cbe8cd4">&#9670;&nbsp;</a></span>ham_j</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_j</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="a16532e80c0e204e028d3475cda56036e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16532e80c0e204e028d3475cda56036e">&#9670;&nbsp;</a></span>ham_t</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">real (Kind=Kind(0.d0))</span>,        <span class="keywordtype">private</span> :: ham_T , ham_U,  Ham_chem<span class="comment">, Ham_h, Ham_J, Ham_xi, XB_X, Phi_X, Ham_tV</span></div><span class="comment"></div><!-- fragment -->
</div>
</div>
<a id="a1e0301588aa05699e0fcfb0d16d4c738"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0301588aa05699e0fcfb0d16d4c738">&#9670;&nbsp;</a></span>ham_tv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_tv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>.</p>

</div>
</div>
<a id="abeb8c11095eba37577f0131f52c49b80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb8c11095eba37577f0131f52c49b80">&#9670;&nbsp;</a></span>ham_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>.</p>

</div>
</div>
<a id="a04b8d5403685aa76c409005a817aa003"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b8d5403685aa76c409005a817aa003">&#9670;&nbsp;</a></span>ham_xi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::ham_xi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>.</p>

</div>
</div>
<a id="a636c1b29569310a368b3377ce1382d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636c1b29569310a368b3377ce1382d8a">&#9670;&nbsp;</a></span>invlist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, private hamiltonian::invlist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">160</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>.</p>

</div>
</div>
<a id="a955eb1417641b40fe24365752fc63942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a955eb1417641b40fe24365752fc63942">&#9670;&nbsp;</a></span>ising_nnlist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, private hamiltonian::ising_nnlist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">170</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="a640dde0b8b9b036b73e855a3feaeb863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640dde0b8b9b036b73e855a3feaeb863">&#9670;&nbsp;</a></span>l1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private hamiltonian::l1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">153</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">Integer</span>,              <span class="keywordtype">private</span> :: L1, L2</div></div><!-- fragment -->
</div>
</div>
<a id="afc044f61c660f6e51f750b378dd88ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc044f61c660f6e51f750b378dd88ff4">&#9670;&nbsp;</a></span>l2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private hamiltonian::l2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00153">153</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="a67d850ae847d6fe0593ee4b4c61423c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d850ae847d6fe0593ee4b4c61423c6">&#9670;&nbsp;</a></span>l_bond</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, private hamiltonian::l_bond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">170</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordtype">Integer</span>,  <span class="keywordtype">allocatable</span> ,  <span class="keywordtype">private</span> :: L_bond(:,:), L_bond_inv(:,:), Ising_nnlist(<span class="comment">:,:)</span></div><span class="comment"></div><!-- fragment -->
</div>
</div>
<a id="a84417401f46ecdbfd3ceae3d80578bd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84417401f46ecdbfd3ceae3d80578bd4">&#9670;&nbsp;</a></span>l_bond_inv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, private hamiltonian::l_bond_inv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00170">170</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>

</div>
</div>
<a id="ad908b6d21bf99ba3ff9dae0fe4d1882d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad908b6d21bf99ba3ff9dae0fe4d1882d">&#9670;&nbsp;</a></span>latt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type (lattice), private hamiltonian::latt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00151">151</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">obsert()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      type(lattice),       <span class="keywordtype">private</span> :: <a class="code" href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">latt</a></div><div class="ttc" id="namespacehamiltonian_html_ad908b6d21bf99ba3ff9dae0fe4d1882d"><div class="ttname"><a href="namespacehamiltonian.html#ad908b6d21bf99ba3ff9dae0fe4d1882d">hamiltonian::latt</a></div><div class="ttdeci">type(lattice), private latt</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00151">Hamiltonian_Examples.f90:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c133d909ccb9361a5c4389a168db634"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c133d909ccb9361a5c4389a168db634">&#9670;&nbsp;</a></span>latt_unit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type (unit_cell), private hamiltonian::latt_unit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00152">152</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00798">setup_ising_action()</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      type(unit_cell),     <span class="keywordtype">private</span> :: <a class="code" href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">latt_unit</a></div><div class="ttc" id="namespacehamiltonian_html_a6c133d909ccb9361a5c4389a168db634"><div class="ttname"><a href="namespacehamiltonian.html#a6c133d909ccb9361a5c4389a168db634">hamiltonian::latt_unit</a></div><div class="ttdeci">type(unit_cell), private latt_unit</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00152">Hamiltonian_Examples.f90:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a837082263f9f0c9dc33bbc733ec52605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a837082263f9f0c9dc33bbc733ec52605">&#9670;&nbsp;</a></span>lattice_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character (len=64), private hamiltonian::lattice_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">158</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>.</p>

</div>
</div>
<a id="a292641502e14286faa4fc4c5e2692ec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a292641502e14286faa4fc4c5e2692ec4">&#9670;&nbsp;</a></span>list</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, private hamiltonian::list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00160">160</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">obsert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">private</span> :: List(:,:), Invlist(:,:)  <span class="comment">! For orbital structure of Unit cell</span></div></div><!-- fragment -->
</div>
</div>
<a id="a643cec8e88998409a6f5ae27915b5e87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643cec8e88998409a6f5ae27915b5e87">&#9670;&nbsp;</a></span>ltrot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::ltrot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00144">144</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="inconfc_8f90_source.html#l00035">confin()</a>, <a class="el" href="outconfc_8f90_source.html#l00036">confout()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, <a class="el" href="tau__m_8f90_source.html#l00053">tau_m_mod::tau_m()</a>, and <a class="el" href="tau__p_8f90_source.html#l00055">tau_p_mod::tau_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">Integer</span>              :: Ltrot</div></div><!-- fragment -->
</div>
</div>
<a id="adfb1ed1c4713279c8bd31e28fffa57b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb1ed1c4713279c8bd31e28fffa57b9">&#9670;&nbsp;</a></span>model</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character (len=64), private hamiltonian::model</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00158">158</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">obsert()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordtype">Character (len=64)</span>,   <span class="keywordtype">private</span> :: Model, Lattice_type</div></div><!-- fragment -->
</div>
</div>
<a id="af508f251b4965d458d35546984d69fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af508f251b4965d458d35546984d69fb2">&#9670;&nbsp;</a></span>n_fl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::n_fl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00142">142</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00763">global_mod::compute_fermion_det()</a>, <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00070">hop_mod::hop_mod_init()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00068">wrapgr_mod::wrapgr_alloc()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00285">wrapgr_mod::wrapgr_placegr()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00351">wrapgr_mod::wrapgr_random_update()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00533">wrapgr_mod::wrapgr_test()</a>, <a class="el" href="wrapgrdo_8f90_source.html#l00034">wrapgrdo()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00178">wrapgr_mod::wrapgrdo()</a>, <a class="el" href="wrapgrup_8f90_source.html#l00033">wrapgrup()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00079">wrapgr_mod::wrapgrup()</a>, <a class="el" href="wrapul_8f90_source.html#l00033">wrapul()</a>, and <a class="el" href="wrapur_8f90_source.html#l00034">wrapur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">Integer</span>              :: N_FL</div></div><!-- fragment -->
</div>
</div>
<a id="ac8b556cb31a51119226fa1b1afa87eb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8b556cb31a51119226fa1b1afa87eb1">&#9670;&nbsp;</a></span>n_sun</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::n_sun</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00143">143</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">obsert()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, and <a class="el" href="upgrade_8f90_source.html#l00101">upgrade2()</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordtype">Integer</span>              :: N_SUN</div></div><!-- fragment -->
</div>
</div>
<a id="a13c80692ce5836cdc65570c6c56b0801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13c80692ce5836cdc65570c6c56b0801">&#9670;&nbsp;</a></span>ndim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::ndim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00141">141</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00763">global_mod::compute_fermion_det()</a>, <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00070">hop_mod::hop_mod_init()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00068">wrapgr_mod::wrapgr_alloc()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00285">wrapgr_mod::wrapgr_placegr()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00351">wrapgr_mod::wrapgr_random_update()</a>, <a class="el" href="wrapgrdo_8f90_source.html#l00034">wrapgrdo()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00178">wrapgr_mod::wrapgrdo()</a>, and <a class="el" href="Wrapgr__mod_8f90_source.html#l00079">wrapgr_mod::wrapgrup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordtype">Integer</span>              :: Ndim</div></div><!-- fragment -->
</div>
</div>
<a id="a47e39398314b7c8194c8736008fc447c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47e39398314b7c8194c8736008fc447c">&#9670;&nbsp;</a></span>nsigma</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class (fields), allocatable hamiltonian::nsigma</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00140">140</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="inconfc_8f90_source.html#l00035">confin()</a>, <a class="el" href="outconfc_8f90_source.html#l00036">confout()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01008">delta_s0_global()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00971">global_move()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="tau__m_8f90_source.html#l00185">tau_m_mod::propr()</a>, <a class="el" href="tau__m_8f90_source.html#l00209">tau_m_mod::proprm1()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, <a class="el" href="upgrade_8f90_source.html#l00101">upgrade2()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00285">wrapgr_mod::wrapgr_placegr()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00351">wrapgr_mod::wrapgr_random_update()</a>, <a class="el" href="wrapgrdo_8f90_source.html#l00034">wrapgrdo()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00178">wrapgr_mod::wrapgrdo()</a>, <a class="el" href="wrapgrup_8f90_source.html#l00033">wrapgrup()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00079">wrapgr_mod::wrapgrup()</a>, <a class="el" href="wrapul_8f90_source.html#l00033">wrapul()</a>, and <a class="el" href="wrapur_8f90_source.html#l00034">wrapur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      class(<a class="code" href="structfields__mod_1_1fields.html">fields</a>)                   ,   <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">nsigma</a></div><div class="ttc" id="structfields__mod_1_1fields_html"><div class="ttname"><a href="structfields__mod_1_1fields.html">fields_mod::fields</a></div><div class="ttdef"><b>Definition:</b> <a href="Fields__mod_8f90_source.html#l00066">Fields_mod.f90:66</a></div></div>
<div class="ttc" id="namespacehamiltonian_html_a47e39398314b7c8194c8736008fc447c"><div class="ttname"><a href="namespacehamiltonian.html#a47e39398314b7c8194c8736008fc447c">hamiltonian::nsigma</a></div><div class="ttdeci">class(fields), allocatable nsigma</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00140">Hamiltonian_Examples.f90:140</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb09a967466f8b65fd016da2d380cb70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb09a967466f8b65fd016da2d380cb70">&#9670;&nbsp;</a></span>obs_eq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type (obser_latt), dimension(:), allocatable, private hamiltonian::obs_eq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00165">165</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01413">init_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      type(obser_latt),  <span class="keywordtype">private</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> ::   <a class="code" href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">obs_eq</a></div><div class="ttc" id="namespacehamiltonian_html_aeb09a967466f8b65fd016da2d380cb70"><div class="ttname"><a href="namespacehamiltonian.html#aeb09a967466f8b65fd016da2d380cb70">hamiltonian::obs_eq</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_eq</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00165">Hamiltonian_Examples.f90:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0801e185b65b8a7f74d6963fd2b5e8bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0801e185b65b8a7f74d6963fd2b5e8bf">&#9670;&nbsp;</a></span>obs_scal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type (obser_vec ), dimension(:), allocatable, private hamiltonian::obs_scal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Privat Observables. </p>

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00164">164</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01413">init_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01101">obser()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      type(obser_vec ),  <span class="keywordtype">private</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> ::   <a class="code" href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">obs_scal</a></div><div class="ttc" id="namespacehamiltonian_html_a0801e185b65b8a7f74d6963fd2b5e8bf"><div class="ttname"><a href="namespacehamiltonian.html#a0801e185b65b8a7f74d6963fd2b5e8bf">hamiltonian::obs_scal</a></div><div class="ttdeci">type(obser_vec), dimension(:), allocatable, private obs_scal</div><div class="ttdoc">Privat Observables. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00164">Hamiltonian_Examples.f90:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaed23e3d96cff5fd9c06aee2339c8e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed23e3d96cff5fd9c06aee2339c8e11">&#9670;&nbsp;</a></span>obs_tau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type (obser_latt), dimension(:), allocatable, private hamiltonian::obs_tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00166">166</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01413">init_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01288">obsert()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01381">pr_obs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      type(obser_latt),  <span class="keywordtype">private</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> ::   <a class="code" href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">obs_tau</a></div><div class="ttc" id="namespacehamiltonian_html_aaed23e3d96cff5fd9c06aee2339c8e11"><div class="ttname"><a href="namespacehamiltonian.html#aaed23e3d96cff5fd9c06aee2339c8e11">hamiltonian::obs_tau</a></div><div class="ttdeci">type(obser_latt), dimension(:), allocatable, private obs_tau</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00166">Hamiltonian_Examples.f90:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a288379d3f41a573b4e2b2274425fbce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288379d3f41a573b4e2b2274425fbce2">&#9670;&nbsp;</a></span>one_dimensional</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private hamiltonian::one_dimensional</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00159">159</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordtype">Logical</span>,              <span class="keywordtype">private</span> :: One_dimensional, Checkerboard</div></div><!-- fragment -->
</div>
</div>
<a id="a0774a95b11b5a1f086afd9e0ec141273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0774a95b11b5a1f086afd9e0ec141273">&#9670;&nbsp;</a></span>op_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type (operator), dimension(:,:), allocatable hamiltonian::op_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00137">137</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00070">hop_mod::hop_mod_init()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00203">hop_mod::hop_mod_mmthl()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00253">hop_mod::hop_mod_mmthl_m1()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00279">hop_mod::hop_mod_mmthl_m1_1d2()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00228">hop_mod::hop_mod_mmthlc()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00131">hop_mod::hop_mod_mmthr()</a>, <a class="el" href="Hop__mod_8f90_source.html#l00154">hop_mod::hop_mod_mmthr_1d2()</a>, and <a class="el" href="Hop__mod_8f90_source.html#l00178">hop_mod::hop_mod_mmthr_m1()</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      type(operator),     <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacehamiltonian.html#a0774a95b11b5a1f086afd9e0ec141273">op_t</a></div><div class="ttc" id="namespacehamiltonian_html_a0774a95b11b5a1f086afd9e0ec141273"><div class="ttname"><a href="namespacehamiltonian.html#a0774a95b11b5a1f086afd9e0ec141273">hamiltonian::op_t</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_t</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00137">Hamiltonian_Examples.f90:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a784fd999e79bf7eea97eb4b7695db65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784fd999e79bf7eea97eb4b7695db65d">&#9670;&nbsp;</a></span>op_v</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type (operator), dimension(:,:), allocatable hamiltonian::op_v</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00136">136</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00668">global_mod::compute_ratio_global()</a>, <a class="el" href="inconfc_8f90_source.html#l00035">confin()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00577">ham_v()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="tau__m_8f90_source.html#l00185">tau_m_mod::propr()</a>, <a class="el" href="tau__m_8f90_source.html#l00209">tau_m_mod::proprm1()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00755">s0()</a>, <a class="el" href="upgrade_8f90_source.html#l00101">upgrade2()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00285">wrapgr_mod::wrapgr_placegr()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00351">wrapgr_mod::wrapgr_random_update()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00533">wrapgr_mod::wrapgr_test()</a>, <a class="el" href="wrapgrdo_8f90_source.html#l00034">wrapgrdo()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00178">wrapgr_mod::wrapgrdo()</a>, <a class="el" href="wrapgrup_8f90_source.html#l00033">wrapgrup()</a>, <a class="el" href="Wrapgr__mod_8f90_source.html#l00079">wrapgr_mod::wrapgrup()</a>, <a class="el" href="wrapul_8f90_source.html#l00033">wrapul()</a>, and <a class="el" href="wrapur_8f90_source.html#l00034">wrapur()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      type(operator),     <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">op_v</a> </div><div class="ttc" id="namespacehamiltonian_html_a784fd999e79bf7eea97eb4b7695db65d"><div class="ttname"><a href="namespacehamiltonian.html#a784fd999e79bf7eea97eb4b7695db65d">hamiltonian::op_v</a></div><div class="ttdeci">type(operator), dimension(:,:), allocatable op_v</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00136">Hamiltonian_Examples.f90:136</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac1b1fa8c65688bd7fdbb7c2ce1c73be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1b1fa8c65688bd7fdbb7c2ce1c73be">&#9670;&nbsp;</a></span>percent_change</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::percent_change</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00155">155</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l01474">global_move_tau()</a>, and <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a884ce86017041b4ec130264300dfb201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a884ce86017041b4ec130264300dfb201">&#9670;&nbsp;</a></span>phi_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::phi_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a2fe26506e76f653d380605147a5dd0aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fe26506e76f653d380605147a5dd0aa">&#9670;&nbsp;</a></span>phi_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::phi_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00156">156</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a77179b40953aaf13f002b7f4fc0b7456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77179b40953aaf13f002b7f4fc0b7456">&#9670;&nbsp;</a></span>projector</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical hamiltonian::projector</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00146">146</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00763">global_mod::compute_fermion_det()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, and <a class="el" href="tau__m_8f90_source.html#l00053">tau_m_mod::tau_m()</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">Logical</span>              :: Projector</div></div><!-- fragment -->
</div>
</div>
<a id="a38fa1c4cce2a1f8143d5a16fbddea3cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38fa1c4cce2a1f8143d5a16fbddea3cf">&#9670;&nbsp;</a></span>symm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical hamiltonian::symm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00148">148</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, <a class="el" href="tau__m_8f90_source.html#l00053">tau_m_mod::tau_m()</a>, and <a class="el" href="tau__p_8f90_source.html#l00055">tau_p_mod::tau_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">Logical</span>              :: Symm</div></div><!-- fragment -->
</div>
</div>
<a id="a2b59a5712728c871c3087c4a273e18c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b59a5712728c871c3087c4a273e18c8">&#9670;&nbsp;</a></span>theta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::theta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00157">157</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a5e72b755eecc2d14135adc1cfdb25f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e72b755eecc2d14135adc1cfdb25f53">&#9670;&nbsp;</a></span>thtrot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer hamiltonian::thtrot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00145">145</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00876">alloc_obs()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, and <a class="el" href="tau__p_8f90_source.html#l00055">tau_p_mod::tau_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">Integer</span>              :: Thtrot </div></div><!-- fragment -->
</div>
</div>
<a id="a3c2ccadb9ff957e46da6a1b7484755f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c2ccadb9ff957e46da6a1b7484755f1">&#9670;&nbsp;</a></span>wf_l</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type (wavefunction), dimension(:), allocatable hamiltonian::wf_l</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00138">138</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00763">global_mod::compute_fermion_det()</a>, <a class="el" href="Global__mod_8f90_source.html#l00105">global_mod::exchange_step()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, and <a class="el" href="main_8f90_source.html#l00113">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      type(wavefunction), <span class="keywordtype">dimension(:)</span>,   <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">wf_l</a></div><div class="ttc" id="namespacehamiltonian_html_a3c2ccadb9ff957e46da6a1b7484755f1"><div class="ttname"><a href="namespacehamiltonian.html#a3c2ccadb9ff957e46da6a1b7484755f1">hamiltonian::wf_l</a></div><div class="ttdeci">type(wavefunction), dimension(:), allocatable wf_l</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00138">Hamiltonian_Examples.f90:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbb663a56d63496d9b9f883e84d527ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbb663a56d63496d9b9f883e84d527ed">&#9670;&nbsp;</a></span>wf_r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type (wavefunction), dimension(:), allocatable hamiltonian::wf_r</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00139">139</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Global__mod_8f90_source.html#l00763">global_mod::compute_fermion_det()</a>, <a class="el" href="Global__mod_8f90_source.html#l00452">global_mod::global_updates()</a>, <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>, <a class="el" href="main_8f90_source.html#l00113">main()</a>, and <a class="el" href="tau__m_8f90_source.html#l00053">tau_m_mod::tau_m()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      type(wavefunction), <span class="keywordtype">dimension(:)</span>,   <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">wf_r</a></div><div class="ttc" id="namespacehamiltonian_html_adbb663a56d63496d9b9f883e84d527ed"><div class="ttname"><a href="namespacehamiltonian.html#adbb663a56d63496d9b9f883e84d527ed">hamiltonian::wf_r</a></div><div class="ttdeci">type(wavefunction), dimension(:), allocatable wf_r</div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian__Examples_8f90_source.html#l00139">Hamiltonian_Examples.f90:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e147e50361e67d0692f6f6306be5a17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e147e50361e67d0692f6f6306be5a17">&#9670;&nbsp;</a></span>xb_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::xb_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00154">154</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>

</div>
</div>
<a id="a49efcdbb93b14e202caa847a20e12d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49efcdbb93b14e202caa847a20e12d3f">&#9670;&nbsp;</a></span>xb_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind(0.d0)), private hamiltonian::xb_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00156">156</a> of file <a class="el" href="Hamiltonian__Examples_8f90_source.html">Hamiltonian_Examples.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="Hamiltonian__Examples_8f90_source.html#l00183">ham_set()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordtype">real (Kind=Kind(0.d0))</span>,        <span class="keywordtype">private</span> :: XB_Y, Phi_Y</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Sep 23 2018 13:52:42 for ALF by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>

% !TEX root = doc.tex
% Copyright (c) 2017-2020 The ALF project.
% This is a part of the ALF project documentation.
% The ALF project documentation by the ALF contributors is licensed
% under a Creative Commons Attribution-ShareAlike 4.0 International License.
% For the licensing details of the documentation see license.CCBYSA.
%
%-----------------------------------------------------------------------------------
\subsubsection{R{\'e}nyi Entropy}
%-----------------------------------------------------------------------------------
The provided module \texttt{entanglement\_mod.F90} allows to compute the $2^{\rm o}$ R\'enyi entropy $S_2$ for a subsystem.
This is obtained by sampling an observable constructed from two independent simulations of the model \cite{Grover13}
\begin{equation}
e^{-S_2} = \sum_{C_1,C_2} P(C_2) P(C_1) {\rm det}\left[G_A(C_1)G_A(C_2)-(\mathds{1} - G_A(C_1))(\mathds{1} - G_A(C_2))\right],
\label{renyi_obs}
\end{equation}
where $G_A(C_i)$, $i=1$, $2$ is the Green's function matrix restricted to the subsystem $A$ in exam, depending on the configuration $C_i$ of the replica $i$.
Due to the formulation, sampling of $S_2$ requires a MPI simulation with at least $2$ tasks.
Only real-space partitions are currently supported.
The degrees of freedom defining the subsystem are identified by the lattice site, flavor, and color indexes.

\begin{lstlisting}[style=fortran]
Call Predefined_Obs_scal_Renyi_Ent(GRC, List, Nsites, N_SUN, ZS, ZP, Obs)
\end{lstlisting}
This subroutine returns an observable \texttt{Obs} such that $\langle\texttt{Obs}\rangle=e^{-S_2}$.
It can be called for different levels of specialization.

In the most general case, \texttt{List(:, N\_FL, N\_SUN)} is a three-dimensional array that contains, for every flavor and color index, the list of lattice sites pertaining to the subsystem. \texttt{Nsites(N\_FL, N\_SUN)} is a bidimensional array that provides the number of lattice sites in the subsystem for every flavor and color index. \texttt{N\_SUN} must be omitted.

For a subsystem whose degrees of freedom, for a given flavor index, have a common value of color indexes, \texttt{Predefined\_Obs\_scal\_Renyi\_Ent} can be called by providing in \texttt{List(:, N\_FL)} a bidimensional array that contains the list of lattice sites for every flavor index. In this case, \texttt{Nsites(N\_FL)} provides the number of sites in the subsystem for any given flavor index, while \texttt{N\_SUN(N\_FL)} contains the number of color indexes for a given flavor index.

Finally, an additional specialization exists for a subsystem whose lattice degrees of freedom are flavor- and color-independent. In this case, \texttt{List(:)} is a one-dimensional array containing the lattice sites of the subsystem. \texttt{Nsites} is the number of sites, and \texttt{N\_SUN} is the number of color indexes belonging to the subsystem.
Accordingly, for every element \texttt{I} of \texttt{List}, the subsystem contains all degrees of freedom with site index \texttt{I}, any flavor index, and \texttt{1} \ldots \texttt{N\_SUN} color index.

\begin{lstlisting}[style=fortran,breaklines=true]
Call Predefined_Obs_scal_Mutual_Inf(GRC, List_A, Nsites_A, List_B, Nsites_B, N_SUN, 
                                    ZS, ZP, Obs )
\end{lstlisting}
This routine computes the observables for the second R\'enyi entropies, which are needed to extract the mutual information between two subsystems $A$ and $B$.
\texttt{List\_A} and \texttt{Nsites\_A} are input parameters describing the subsystem $A$, with the same conventions and specializations described above.
\texttt{List\_B} and \texttt{Nsites\_B} are the corresponding input parameters for the subsystem $B$. \texttt{N\_SUN} is assumed to be identical for $A$ and $B$.
\texttt{Renyi\_A}, \texttt{Renyi\_B}, and \texttt{Renyi\_AB} are the output observables, pertaining to $A$, $B$, and $A\cup B$. The mutual information between $A$ and $B$ is $I_2=-\ln \langle \texttt{Renyi\_A}\rangle -\ln \langle \texttt{Renyi\_B}\rangle +\ln \langle \texttt{Renyi\_AB}\rangle$.

% Copyright (c) 2016, 2020 The ALF project.
% This is a part of the ALF project documentation.
% The ALF project documentation by the ALF contributors is licensed
% under a Creative Commons Attribution-ShareAlike 4.0 International License.
% For the licensing details of the documentation see license.CCBYSA.

% !TEX root = doc.tex

\subsubsection{Dimer-Dimer correlations }
Let  
\begin{equation}
	\hat{S}^{\mu}_{\, \,  \nu} (x)  =  \hat{c}^{\dagger}_{x,\mu} \hat{c}^{}_{x,\nu}    - \delta_{\mu,\nu} \frac{1}{N}  \sum_{\alpha = 1}^{N} \hat{c}^{\dagger}_{x,\alpha} \hat{c}^{}_{x,\alpha}
\end{equation}
be the generators of SU(N). 
Dimer-Dimer correlations are defined  as: 
\begin{equation}
 \langle \langle \hat{S}^{\mu}_{\, \,  \nu} (x,\tau)   \hat{S}^{\nu}_{\, \,  \mu} (y,\tau) 
              \hat{S}^{\gamma}_{\, \,  \delta} (w)   \hat{S}^{\delta}_{\, \,  \gamma} (z)   \rangle   \rangle_C  ,
\end{equation}
where the sum   over repeated indices   from $ 1 \cdots N $ is implied. 
The calculation is carried out  for the self-adjoint antisymmetric  representation of SU(N)   for which $ \sum_{\alpha = 1}^{N} \hat{c}^{\dagger}_{x,\alpha} \hat{c}^{}_{x,\alpha}  = N/2$,   such that the generators can be replaced by: 
\begin{equation}
	\hat{S}^{\mu}_{\, \,  \nu} (x)  =  \hat{c}^{\dagger}_{x,\mu} \hat{c}^{}_{x,\nu}    - \delta_{\mu,\nu} \frac{1}{2}. 
\end{equation}
The  function 
\begin{lstlisting}[style=fortran]
Complex (Kind=Kind(0.d0)) function Predefined_Obs_dimer_tau(x, y, w, z, GT0, G0T, G00,
                                                            GTT, N_SUN, N_FL)  
\end{lstlisting}
returns the   value of the time-displaced dimer-dimer correlation function. 
The  function 
\begin{lstlisting}[style=fortran]
Complex (Kind=Kind(0.d0)) function Predefined_Obs_dimer_eq(x, y, w, z, GR, GRC, N_SUN,
                                                           N_FL)
\end{lstlisting}
returns the   value of the equal time  dimer-dimer correlation function:
\begin{equation}
 \langle \langle \hat{S}^{\mu}_{\, \,  \nu} (x,\tau)   \hat{S}^{\nu}_{\, \,  \mu} (y,\tau) 
              \hat{S}^{\gamma}_{\, \,  \delta} (w,\tau)   \hat{S}^{\delta}_{\, \,  \gamma} (z,\tau)   \rangle   \rangle_C.  
\end{equation}
Here,  both \texttt{GR}  and  \texttt{GRC}  are on time slice  $\tau$.

To compute the background terms, the function
\begin{lstlisting}[style=fortran]
Complex (Kind=Kind(0.d0)) function Predefined_Obs_dimer0_eq(x, y, GR, N_SUN, N_FL)
\end{lstlisting}
returns 
\begin{equation}
 \langle \langle \hat{S}^{\mu}_{\, \,  \nu} (x,\tau)   \hat{S}^{\nu}_{\, \,  \mu} (y,\tau)  \rangle   \rangle_C .
\end{equation} 

All routines  are programmed  for \texttt{N\_SUN = 2,4,6,8} at \texttt{N\_FL=1}.   The routines also handle the case of broken SU(2)  spin symmetry corresponding  to  \texttt{N\_FL=2}  and \texttt{N\_SUN=1}.   To carry out the Wick decomposition  and sums over  spin indices,  we use the  Mathematica  notebooks 
 \texttt{Dimer\-Dimer\_SU2\_NFL\_2.nb}  and \texttt{Dimer\-Dimer\_SUN\_NFL\_1.nb}.


\subsubsection{Cotunneling for Kondo models}

The  Kondo lattice model (KLM), $\hat{H}_{KLM}$   is obtained by carrying out a   canonical Schrieffer-Wolf  \cite{Schrieffer66}  transformation  of the   periodic Anderson model (PAM), $\hat{H}_{PAM}$.    Hence, $e^{\hat{S}}  $ $\hat{H}_{PAM} $$ e^{-S}   = \hat{H}_{KLM}$  with  $\hat{S}^\dagger = - \hat{S}$.     Let $\hat{f}_{x,\sigma} $  create an  electron on the   correlation f-orbital of the   PAM.  Then, 
\begin{equation}
	e^{\hat{S}} \hat{f}^{\dagger}_{x,\sigma'} e^{-\hat{S}}   \simeq  
     \frac{2V}{U}  \left( \hat{c}^{\dagger}_{x,-\sigma'}  \hat{S}^{\sigma'}_{x} +  \sigma'   \hat{c}^{\dagger}_{x,\sigma'} \hat{S}^{z}_x   \right)  \equiv  \frac{2V}{U}   \tilde{\hat{f}}^{\dagger}_{x,\sigma'} .  
\end{equation}
In the above, it is understood that $\sigma'$ takes the value $1$ ($-1$)  for up  (down) spin degrees of freedom, that  $  \hat{S}^{\sigma'}_{x} =  f^{\dagger}_{x,\sigma'} \hat{f}^{}_{x,-\sigma'}  $  and that 
$ \hat{S}^{z}_{x} = \frac{1}{2} \sum_{\sigma'}  \sigma' \hat{f}^{\dagger}_{x,\sigma'} \hat{f}^{}_{x,\sigma'} $.  Finally, $\hat{c}^{\dagger}_{x,\sigma'}$ corresponds to the conduction electron that hybridizes with $\hat{f}^{\dagger}_{x,\sigma'}$.  This form matches that derived in Ref.~\cite{Costi00} and a  calculation  of the former equation can be found in Ref.~\cite{Raczkowski18}.  An identical, but more transparent formulation is given in  Ref.~\cite{Maltseva09}   and reads: 
\begin{equation}
 	\tilde{\hat{f}}^{\dagger}_{x,\sigma} = \sum_{\sigma'} \hat{c}^{\dagger}_{x,\sigma'} \ve{\sigma}_{\sigma',\sigma} \cdot  \hat{\ve{S}}_x,
\end{equation}
where $\ve{\sigma}$  denotes  the vector of Pauli spin matrices.    With the above,  one will readily show that the  $ \tilde{\hat{f}}^{\dagger}_{x,\sigma} $  transforms as  $ \hat{f}^{\dagger}_{x,\sigma} $   under an SU(2)  spin rotation. 
The  function 
\begin{lstlisting}[style=fortran]
Complex (Kind=Kind(0.d0)) function Predefined_Obs_Cotunneling(x_c, x, y_c, y, GT0, G0T,
                                                              G00, GTT, N_SUN, N_FL)
\end{lstlisting}
returns the   value of the time displaced correlation function: 
\begin{equation}
	\sum_{\sigma} \langle \langle   \tilde{\hat{f}}^{\dagger}_{x,\sigma}(\tau)  \tilde{\hat{f}}_{y,\sigma}(0)   \rangle \rangle_{C} .
\end{equation}
Here, $x_c$ and $y_c$ correspond to the  conduction orbitals that hybridize with the  $x$ and $y$ f-orbitals.  The routine  works for  SU(N)  symmetric codes  corresponding to   \texttt{N\_FL=1}  and \texttt{N\_SUN = 2,4,6,8}.  For the larger N-values,  we have replaced the generators of SU(2)  with that of SU(N).  The routine also handles the case where spin-symmetry is broken by e.g. a  Zeeman field. This  corresponds to the 
case  \texttt{N\_FL=2}  and \texttt{N\_SUN=1}.    Note that the function only  carries out the Wick decomposition   and the handling  of the observable  type corresponding to this quantity   has to be done by the user.     To carry out the Wick decomposition  and sums over  spin indices,  we use the  Mathematica  notebooks 
\texttt{Cotunneling\_SU2\_NFL\_2.nb}  and  \texttt{Cotunneling\_SUN\_NFL\_1.nb}. 
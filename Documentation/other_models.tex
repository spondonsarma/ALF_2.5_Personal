% Copyright (c) 2016 The ALF project.
% This is a part of the ALF project documentation.
% The ALF project documentation by the ALF contributors is licensed
% under a Creative Commons Attribution-ShareAlike 4.0 International License.
% For the licensing details of the documentation see license.CCBYSA.

% !TEX root = Doc.tex
%-------------------------------------------------------------------------------------
\subsection{Other models}
%-------------------------------------------------------------------------------------
\label{sec:other_models}

The aim of this section is to briefly mention  a small  selection of  other models that can be studied using the QMC code of the ALF project.  
  
%-------------------------------------------------------------------------------------
\subsubsection{Kondo lattice model}
%-------------------------------------------------------------------------------------

Simulating the Kondo lattice with the QMC code of the ALF project    requires rewriting of the model along the lines of Refs.~\cite{Assaad99a,Capponi00,Beach04}.  
Adopting the notation of these articles,   the Hamiltonian that one will simulate reads: 
 \begin{equation}\label{eqn:ham_kondo}
 	\hat{\mathcal{H}}  = 
	\underbrace{-t \sum_{\langle  \vec{i},\vec{j} \rangle,\sigma} \left( \hat{c}_{\vec{i},\sigma}^{\dagger}  \hat{c}_{\vec{j},\sigma}^{\phantom\dagger}   + \text{H.c.} \right) }_{\equiv \hat{\mathcal{H}}_t} - \frac{J}{4} 
	\sum_{\vec{i}} \left( \sum_{\sigma} \hat{c}_{\vec{i},\sigma}^{\dagger}  \hat{f}_{\vec{i},\sigma}^{\phantom\dagger}  + 
	                                                        \hat{f}_{\vec{i},\sigma}^{\dagger}  \hat{c}_{\vec{i},\sigma}^{\phantom\dagger}   \right)^{2}   +
        \underbrace{\frac{U}{2}   \sum_{\vec{i}}   \left( \hat{n}^{f}_{\vec{i}} -1 \right)^2}_{\equiv \hat{\mathcal{H}}_U}.
 \end{equation}
This form is included in the general Hamiltonian (\ref{eqn:general_ham})  such that the above Hamiltonian can  be implemented in our program package.  
The  relation to the Kondo lattice model follows  from expanding the square  of the hybridization to obtain: 
 \begin{equation}
 	\hat{\mathcal{H}}  =\hat{\mathcal{H}}_t   
	+ J \sum_{\vec{i}}  \left(  \hat{\vec{S}}^{c}_{\vec{i}} \cdot  \hat{\vec{S}}^{f}_{\vec{i}}    +   \hat{\eta}^{z,c}_{\vec{i}} \cdot  \hat{\eta}^{z,f}_{\vec{i}}  
		-  \hat{\eta}^{x,c}_{\vec{i}} \cdot  \hat{\eta}^{x,f}_{\vec{i}}  -  \hat{\eta}^{y,c}_{\vec{i}} \cdot  \hat{\eta}^{y,f}_{\vec{i}} \right) 
	 + \hat{\mathcal{H}}_U.
 \end{equation}
 where the $\eta$-operators  relate to the spin-operators via a particle-hole transformation in one spin sector: 
 \begin{equation} 
 	\hat{\eta}^{\alpha}_{\vec{i}}  = \hat{P}^{-1}  \hat{S}^{\alpha}_{\vec{i}} \hat{P}  	\; \text{ with }  \;   
	\hat{P}^{-1}  \hat{c}^{\phantom\dagger}_{\vec{i},\uparrow} \hat{P}  =   (-1)^{i_x+i_y} \hat{c}^{\dagger}_{\vec{i},\uparrow}  \; \text{ and }  \;   
	\hat{P}^{-1}  \hat{c}^{\phantom\dagger}_{\vec{i},\downarrow} \hat{P}  = \hat{c}^{\phantom\dagger}_{\vec{i},\downarrow} 
 \end{equation}
 Since the $\hat{\eta}^{f} $- and $ \hat{S}^{f} $-operators  do not alter the  parity [$(-1)^{\hat{n}^{f}_{\vec{i}}}$ ] of the $f$-sites, 
 \begin{equation}
 	\left[  \hat{\mathcal{H}}, \hat{\mathcal{H}}_U \right] = 0.
 \end{equation}
 Thereby,  and for positive values of $U$ ,  doubly occupied  or empty $f$-sites -- corresponding to even parity sites -- are suppressed  by a  Boltzmann factor 
 $e^{-\beta U/2} $ in comparison to odd parity sites.   Choosing $\beta U $ adequately essentially allows to  restrict the Hilbert space to  odd parity $f$-sites.  
 In this Hilbert space $\hat{\eta}^{x,f} = \hat{\eta}^{y,f} =  \hat{\eta}^{z,f} =0$  such that the Hamiltonian (\ref{eqn:ham_kondo}) reduces to the Kondo lattice model. 

%-------------------------------------------------------------------------------------
\subsubsection{SU(N) Hubbard-Heisenberg models}
%-------------------------------------------------------------------------------------

SU(2N) Hubbard-Heisenberg \cite{Assaad04,Lang13} models can be written as:
\begin{equation}
 \hat{\mathcal{H}}  =  
 \underbrace{ - t \sum_{ \langle \vec{i},\vec{j} \rangle }    \left(  \vec{\hat{c}}^{\dagger}_{\vec{i}}  \vec{\hat{c}}^{\phantom{\dagger}}_{\vec{j}} + \text{H.c.} \right) }_{\equiv \hat{\mathcal{H}}_t} \; \; 
\underbrace{ -\frac{J}{2 N}  \sum_{ \langle \vec{i},\vec{j} \rangle  } \left(
           \hat{D}^{\dagger}_{ \vec{i},\vec{j} }\hat{D}^{\phantom\dagger}_{ \vec{i},\vec{j}}  +
            \hat{D}^{\phantom\dagger}_{ \vec{i},\vec{j} } \hat{D}^{\dagger}_{ \vec{i},\vec{j} }  \right) }_{\equiv\hat{\mathcal{H}}_J}
            + 
 \underbrace{\frac{U}{N}  \sum_{\vec{i}} \left(
             \vec{\hat{c}}^{\dagger}_{\vec{i}}  \vec{\hat{c}}^{\phantom\dagger}_{\vec{i}} -  {\frac{N}{2} } \right)^2}_{\equiv \hat{\mathcal{H}}_U}
\end{equation}
Here,
$ \vec{\hat{c}}^{\dagger}_{\vec{i}} =
(\hat{c}^{\dagger}_{\vec{i},1},  \hat{c}^{\dagger}_{\vec{i},2}, \cdots, \hat{c}^{\dagger}_{\vec{i}, N } ) $  is an
$N$-flavored spinor, and $ \hat{D}_{ \vec{i},\vec{j}} = \vec{\hat{c}}^{\dagger}_{\vec{i}}
\vec{\hat{c}}_{\vec{j}}  $.
To use the QMC code of the ALF project  to simulate this model, one will rewrite  the $J$-term as a sum of perfect squares, 
\begin{equation}
        \hat{\mathcal{H}}_J =  -\frac{J}{4 N}  \sum_{  \langle \vec{i}, \vec{j} \rangle }
        \left(\hat{D}^{\dagger}_{  \langle \vec{i}, \vec{j} \rangle  } +  \hat{D}_{  \langle \vec{i}, \vec{j} \rangle }  \right)^2  -
        \left(\hat{D}^{\dagger}_{   \langle \vec{i}, \vec{j} \rangle } -  \hat{D}_{  \langle \vec{i}, \vec{j} \rangle}  \right)^2,
\end{equation}
so to manifestly bring it into the form of the general Hamiltonian(\ref{eqn:general_ham}). 
It is amusing to note that setting the hopping $t=0$,    charge fluctuations  will be suppressed by the  Boltzmann factor $e^{-\beta U /N \left(  \vec{\hat{c}}^{\dagger}_{\vec{i}}  \vec{\hat{c}}^{\phantom\dagger}_{\vec{i}} -  {\frac{N}{2} } \right)^2 } $ 
\mycomment{MB: corrected minus sign in the exponent}
since in this case  $ \left[   \hat{\mathcal{H}}, \hat{\mathcal{H}}_U \right]  = 0 $.
\mycomment{MB: I suggest to use only the J-term here, $ \left[   \hat{\mathcal{H}}_{J}, \hat{\mathcal{H}}_U \right]  = 0 $.}
This provides a route to use the auxiliary field QMC algorithm  to simulate -- free of the sign problem -- SU(2N) Heisenberg models in the self-adjoint antisymmetric representation  \footnote{ This corresponds to a Young tableau with single column and $N/2$ rows.}  
For odd values of $N$ recent progress  in our understanding of the  origins of the sign problem \cite{Wei16}  allows us to simulate  a set of non-trivial Hamiltonians \cite{Li15,Assaad16},  without encountering the sign problem.

%-------------------------------------------------------------------------------------
\subsubsection{Hubbard  model in the canonical ensemble}
%-------------------------------------------------------------------------------------

To simulate the Hubbard model in the canonical ensemble  one can add the constraint: 
\begin{equation}
	\hat{\mathcal{H}}   = \hat{\mathcal{H}_{tU}}     + \underbrace{\lambda \left( \hat{N} -  N \right)^{2}}_{\equiv \hat{H}_\lambda }
\end{equation}
In the limit $\lambda \rightarrow \infty $, the uniform charge fluctuations,
\begin{equation} 
      S ( \vec{q} = 0)   =  \sum_{\vec{r}}   \left[ \langle \hat{n}_{\vec{r}}  \hat{n}_{\vec{0}} \rangle  - \langle \hat{n}_{\vec{r}}\rangle \langle  \hat{n}_{\vec{0}} \rangle  \right]
\end{equation} 
are suppressed and the grand-canonical simulation maps onto a canonical one.  
To implement this in the QMC code of the ALF project,  we have adopted the following strategy.   Since  $ \left( \hat{N} -  N \right)^{2}  $ effectively corresponds to a long-range interaction one may   face the issue that the acceptance rate of a single  HS flip becomes very small on large lattices. To circumvent this problem we have  used the following decomposition: 
\begin{equation}
	e^{-\beta \hat{H}}  =   \prod_{\tau = 1}^{L_{\text{Trotter}}} \left[  e^{-\Delta \tau \hat{H}_t} e^{-\Delta \tau \hat{H}_U}  
	\underbrace{e^{-\frac{\Delta \tau}{n_{\lambda}} \hat{H}_{\lambda} } \cdots e^{-\frac{\Delta \tau}{n_{\lambda}} \hat{H}_{\lambda} } }_{n_\lambda \text{-times } }\right].
\end{equation}
Thereby, we need $n_\lambda $ fields per time slice  to impose the constraint.  Since for each field the coupling  constant is suppressed by a factor $n_{\lambda}$, we can monitor the acceptance. 
An implementation of this program can be found in  \path{Prog/Hamiltonian_Hub_Canonical.f90}  and a test run in the directory \path{Examples/Hubbard_Mz_Square_Can}
